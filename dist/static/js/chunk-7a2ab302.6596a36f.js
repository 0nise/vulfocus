(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7a2ab302"],{"0dec":function(t,e,n){t.exports=n("f292")},"11e9":function(t,e,n){var a=n("52a7"),s=n("4630"),i=n("6821"),r=n("6a99"),o=n("69a8"),c=n("c69a"),u=Object.getOwnPropertyDescriptor;e.f=n("9e1e")?u:function(t,e){if(t=i(t),e=r(e,!0),c)try{return u(t,e)}catch(n){}if(o(t,e))return s(!a.f.call(t,e),t[e])}},"153a":function(t,e,n){},"2b1b":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-row",[t._l(t.timelist,(function(e,a){return n("el-col",{key:a,attrs:{span:16}},[n("el-card",[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[t._v("时间模式信息")]),t._v(" "),0===t.countlist.length?n("el-tooltip",{attrs:{content:"未启动"}},[n("i",{staticClass:"fa fa-stop",attrs:{"aria-hidden":"true"}})]):e.temp_id===t.countlist[0].temp_time_id?n("el-tooltip",{attrs:{content:"运行中"}},[n("i",{staticClass:"el-icon-loading",staticStyle:{color:"#20a0ff"}})]):t._e()],1),t._v(" "),n("el-container",[n("el-aside",{attrs:{width:"356px"}},[e.image_name!==t.imgpath?n("img",{attrs:{src:e.image_name,alt:"",width:"356px",height:"248px"}}):t._e()]),t._v(" "),n("el-main",{staticStyle:{"margin-top":"-15px"}},[n("el-row",[n("el-col",{attrs:{span:19}},[n("span",{staticClass:"info2"},[t._v(t._s(e.name))])])],1),t._v(" "),n("el-row",{staticStyle:{"margin-top":"25px"}},[n("el-col",{attrs:{span:5}},[n("span",{staticClass:"info3"},[t._v("计时时间")])]),t._v(" "),n("el-col",{attrs:{span:19}},[t._v("\n                  "+t._s(e.time_range)+"分钟\n                ")])],1),t._v(" "),n("el-row",{staticStyle:{"margin-top":"20px"}},[n("el-col",{attrs:{span:5}},[n("span",{staticClass:"info3"},[t._v("rank范围")])]),t._v(" "),n("el-col",{attrs:{span:19}},[t._v("\n                  "+t._s(e.rank_range)+"\n                ")])],1),t._v(" "),n("el-row",{staticStyle:{"margin-top":"20px"}},[n("el-col",{attrs:{span:5}},[n("span",{staticClass:"info3"},[t._v("当前排名")])]),t._v(" "),n("el-col",{attrs:{span:19}},[0===t.currentRank?n("span",[t._v("\n                    未上榜\n                  ")]):t.currentRank>0?n("span",[t._v("\n                    "+t._s(t.currentRank)+"\n                  ")]):t._e()])],1),t._v(" "),n("el-row",{staticStyle:{"margin-top":"20px"}},[n("el-col",{attrs:{span:5}},[n("span",{staticClass:"info3"},[t._v("倒计时")])]),t._v(" "),n("el-col",{attrs:{span:19}},[t.countlist.length>0&&t.countlist[0].temp_time_id===e.temp_id?n("count-down",{staticStyle:{"margin-top":"-15px"},attrs:{currentTime:t.countlist[0].start_date,startTime:t.countlist[0].start_date,endTime:t.countlist[0].end_date,dayTxt:"天",hourTxt:"小时",minutesTxt:"分钟",secondsTxt:"秒"},on:{end_callback:function(e){return t.autostop()}}}):n("span",[t._v("未开始")])],1)],1),t._v(" "),0!==t.countlist.length?n("el-row",{staticStyle:{"margin-top":"20px"}},[e.temp_id!==t.countlist[0].temp_time_id?n("el-button",{staticClass:"btn1",staticStyle:{"margin-top":"-15px"},attrs:{size:"mini"},on:{click:function(n){return t.handleOk(e)}}},[n("span",{staticClass:"span1"},[n("i",{staticClass:"el-icon-video-play",staticStyle:{"margin-right":"2px"}}),t._v("启动盲盒")])]):t._e(),t._v(" "),e.temp_id===t.countlist[0].temp_time_id?n("el-button",{staticClass:"btn1",staticStyle:{"margin-top":"-15px"},attrs:{size:"mini"},on:{click:function(e){return t.stop()}}},[n("span",{staticClass:"span1"},[n("i",{staticClass:"el-icon-loading",staticStyle:{"margin-right":"2px"}}),t._v("停止盲盒")])]):t._e()],1):0===t.countlist.length?n("el-row",{staticStyle:{"margin-top":"20px"}},[n("el-col",[n("el-button",{staticClass:"btn1",attrs:{size:"mini"},on:{click:function(n){return t.opendialog(e)}}},[n("span",{staticClass:"span1"},[n("i",{staticClass:"el-icon-video-play",staticStyle:{"margin-right":"2px"}}),t._v("启动盲盒")])]),t._v("\n                  该场景已有\n                  "),n("span",{staticClass:"span5"},[t._v(t._s(t.page.total))]),t._v("\n                  人参加\n                ")],1)],1):t._e()],1),t._v(" "),n("el-aside",{attrs:{width:"60px"}},[n("el-row",[n("el-col",[n("span",{staticClass:"txt8"},[t._v(t._s(t.currentScore))]),t._v(" "),n("span",{staticClass:"word5"},[t._v("分")])])],1)],1)],1),t._v(" "),n("el-divider"),t._v(" "),n("el-container",[n("el-main",[n("el-row",[n("span",{staticClass:"span2"},[t._v("盲盒描述")])]),t._v(" "),n("el-row",{staticStyle:{"margin-top":"24px"}},[n("span",{staticClass:"span3"},[t._v(" "+t._s(e.time_desc)+" ")])])],1)],1)],1)],1)})),t._v(" "),n("el-col",{staticStyle:{"margin-left":"10px"},attrs:{span:7}},[n("el-card",[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[t._v("时间模式排名")])]),t._v(" "),n("div",[n("el-table",{attrs:{data:t.tableData}},[n("el-table-column",{attrs:{type:"index",label:"排名",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.page.currentPageNum*t.page.size+e.$index+1-t.page.size>=4?n("p",{staticStyle:{"margin-left":"15px"}},[t._v(t._s(t.page.currentPageNum*t.page.size+e.$index+1-t.page.size))]):t._e(),t._v(" "),t.page.currentPageNum*t.page.size+e.$index+1-t.page.size===1?n("svg-icon",{staticStyle:{"margin-left":"15px",height:"48px"},attrs:{"icon-class":"trophy1"}}):t._e(),t._v(" "),t.page.currentPageNum*t.page.size+e.$index+1-t.page.size===2?n("svg-icon",{staticStyle:{"margin-left":"15px",height:"48px"},attrs:{"icon-class":"trophy2"}}):t._e(),t._v(" "),t.page.currentPageNum*t.page.size+e.$index+1-t.page.size===3?n("svg-icon",{staticStyle:{"margin-left":"15px",height:"48px"},attrs:{"icon-class":"trophy3"}}):t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"name","show-overflow-tooltip":!0,label:"用户名"}}),t._v(" "),n("el-table-column",{attrs:{prop:"rank",label:"积分",width:"180"}})],1)],1),t._v(" "),n("div",{staticStyle:{"margin-top":"20px"}},[n("el-pagination",{attrs:{"page-size":t.page.size,layout:"total, prev, pager, next, jumper",total:t.page.total},on:{"current-change":t.StateChange}})],1)])],1)],2),t._v(" "),n("div",{staticStyle:{"margin-top":"20px"}})],1)},s=[],i=n("db72"),r=n("2f62"),o=n("0dec"),c=n.n(o),u=n("905e"),l={name:"timeindex.vue",components:{CountDown:c.a},data:function(){return{search:"",get_time:"",timelist:[],countlist:[],tableData:[],imgpath:"/images/",modelimg:n("aa63"),page:{total:0,size:20,page:1,currentPageNum:1},currentRank:0,currentScore:0,rankList:[]}},computed:Object(i["a"])({},Object(r["b"])(["name","avatar","roles","rank"])),created:function(){this.templist(),this.gettimelist(),this.StateChange()},methods:{gettimelist:function(){var t=this;Object(u["a"])().then((function(e){var n=e.data.results;t.countlist=n,0===t.countlist.length||(t.countlist[0].end_date=u["b"].getTimestamp(t.countlist[0].end_date),t.countlist[0].start_date=u["b"].getTimestamp(t.get_time))}))},templist:function(){var t=this,e=this.$route.query.temp_id;void 0!==e&&null!=e&&""!==e||(this.$message({message:"参数不能为空",type:"error"}),this.$router.push({path:"/scene/list"})),Object(u["c"])(e).then((function(e){var a=e.data;a.image_name?a.image_name="/images/"+a.image_name:a.image_name=n("aa63"),t.timelist.push(a)}))},stop:function(){var t=this;this.$confirm("是否取消挑战?","提示",{center:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(u["e"])().then((function(e){var n=e.data,a="success",s="";"2000"===n.code?s="计时模式已经关闭！":(a="error",s="关闭失败,内部错误"),t.$message({type:a,message:s})})),t.$router.push({path:"/dashboard"})})).catch((function(){t.$message({type:"info",message:"已取消"})}))},opendialog:function(t){var e=this;this.item=t,!0===t.flag_status?this.$message({type:"error",message:t.time_range+"分钟挑战赛已经开始"}):this.$confirm("是否开始挑战?","提示",{center:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(u["d"])(t).then((function(t){var n=t.data,a="success",s="";"200"===n.code?s="计时模式开始启动！":"2001"===n.code?s="计时模式已经启动，请勿重新启动":(a="error",s="内部错误"),e.$message({type:a,message:s})})),e.$router.push({path:"/dashboard"})})).catch((function(){e.$message({type:"info",message:"已取消挑战"})}))},handleOk:function(t){0===this.countlist.length?this.opendialog(t):this.$message({message:"已有时间模式在运行，请先关闭",type:"error"})},autostop:function(){var t=this;Object(u["e"])().then((function(e){var n=e.data,a="success",s="";"2000"===n.code?s="计时模式已经关闭！":(a="error",s="关闭失败,内部错误"),t.$message({type:a,message:s})}))},StateChange:function(t){var e=this;this.page.currentPageNum=t;var n=this.$route.query.temp_id;void 0!==n&&null!=n&&""!==n||(this.$message({message:"参数不能为空",type:"error"}),this.$router.push({path:"/scene/list"})),Object(u["f"])(n,t).then((function(t){e.tableData=t.data.results,e.page.total=t.data.count,e.currentScore=t.data.current_score,e.currentRank=t.data.current_rank,e.page.currentPageNum=1}))}},mounted:function(){var t=this,e=(new Date).getFullYear(),n=(new Date).getMonth()+1,a=(new Date).getDate(),s=(new Date).getHours(),i=(new Date).getMinutes()<10?"0"+(new Date).getMinutes():(new Date).getMinutes(),r=(new Date).getSeconds()<10?"0"+(new Date).getSeconds():(new Date).getSeconds();t.get_time=e+"-"+n+"-"+a+" "+s+":"+i+":"+r}},p=l,m=(n("48df"),n("2877")),d=Object(m["a"])(p,a,s,!1,null,"76583604",null);e["default"]=d.exports},"48df":function(t,e,n){"use strict";n("153a")},"5dbc":function(t,e,n){var a=n("d3f4"),s=n("8b97").set;t.exports=function(t,e,n){var i,r=e.constructor;return r!==n&&"function"==typeof r&&(i=r.prototype)!==n.prototype&&a(i)&&s&&s(t,i),t}},"8b97":function(t,e,n){var a=n("d3f4"),s=n("cb7c"),i=function(t,e){if(s(t),!a(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,a){try{a=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),a(t,[]),e=!(t instanceof Array)}catch(s){e=!0}return function(t,n){return i(t,n),e?t.__proto__=n:a(t,n),t}}({},!1):void 0),check:i}},"905e":function(t,e,n){"use strict";n.d(e,"d",(function(){return s})),n.d(e,"e",(function(){return i})),n.d(e,"a",(function(){return r})),n.d(e,"g",(function(){return o})),n.d(e,"i",(function(){return c})),n.d(e,"h",(function(){return u})),n.d(e,"j",(function(){return l})),n.d(e,"c",(function(){return p})),n.d(e,"f",(function(){return m})),n.d(e,"b",(function(){return d}));var a=n("b775");function s(t){return Object(a["a"])({url:"/time/",method:"post",data:t})}function i(){return Object(a["a"])({url:"/time/",method:"delete"})}function r(){return Object(a["a"])({url:"/time/",method:"get"})}function o(t){return Object(a["a"])({url:"/timetemp/",method:"post",data:t})}function c(t){var e="";!0===t&&(e="flag"),"temp"===t&&(e="temp");var n="/timetemp/?query=&flag="+e;return Object(a["a"])({url:n,method:"get"})}function u(t){return Object(a["a"])({url:"/timetemp/"+t+"/",method:"delete",data:{id:t}})}function l(t){return void 0!==t&&null!==t||(t=1),Object(a["a"])({url:"/rank/user/?page="+t,method:"get"})}function p(t){return Object(a["a"])({url:"/time/"+t+"/get/",method:"get"})}function m(t,e){return void 0!==e&&null!==e||(e=1),Object(a["a"])({url:"/timerank/?value="+t+"&page="+e,method:"get"})}var d={getTimestamp:function(t){return new Date(t).getTime()/1e3}}},9093:function(t,e,n){var a=n("ce10"),s=n("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return a(t,s)}},aa63:function(t,e,n){t.exports=n.p+"static/img/modelbg.fcbe2049.jpg"},aa77:function(t,e,n){var a=n("5ca1"),s=n("be13"),i=n("79e5"),r=n("fdef"),o="["+r+"]",c="​",u=RegExp("^"+o+o+"*"),l=RegExp(o+o+"*$"),p=function(t,e,n){var s={},o=i((function(){return!!r[t]()||c[t]()!=c})),u=s[t]=o?e(m):r[t];n&&(s[n]=u),a(a.P+a.F*o,"String",s)},m=p.trim=function(t,e){return t=String(s(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(l,"")),t};t.exports=p},c5f6:function(t,e,n){"use strict";var a=n("7726"),s=n("69a8"),i=n("2d95"),r=n("5dbc"),o=n("6a99"),c=n("79e5"),u=n("9093").f,l=n("11e9").f,p=n("86cc").f,m=n("aa77").trim,d="Number",h=a[d],g=h,f=h.prototype,_=i(n("2aeb")(f))==d,v="trim"in String.prototype,y=function(t){var e=o(t,!1);if("string"==typeof e&&e.length>2){e=v?e.trim():m(e,3);var n,a,s,i=e.charCodeAt(0);if(43===i||45===i){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===i){switch(e.charCodeAt(1)){case 66:case 98:a=2,s=49;break;case 79:case 111:a=8,s=55;break;default:return+e}for(var r,c=e.slice(2),u=0,l=c.length;u<l;u++)if(r=c.charCodeAt(u),r<48||r>s)return NaN;return parseInt(c,a)}}return+e};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof h&&(_?c((function(){f.valueOf.call(n)})):i(n)!=d)?r(new g(y(e)),n,h):y(e)};for(var b,T=n("9e1e")?u(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;T.length>x;x++)s(g,b=T[x])&&!s(h,b)&&p(h,b,l(g,b));h.prototype=f,f.constructor=h,n("2aba")(a,d,h)}},f292:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.msTime.show?n("p",[t.msTime.day>0?n("span",[n("span",[t._v(t._s(t.msTime.day))]),n("i",[t._v(t._s(t.dayTxt))])]):t._e(),t._v(" "),n("span",[t._v(t._s(t.msTime.hour))]),n("i",[t._v(t._s(t.hourTxt))]),t._v(" "),n("span",[t._v(t._s(t.msTime.minutes))]),n("i",[t._v(t._s(t.minutesTxt))]),t._v(" "),n("span",[t._v(t._s(t.msTime.seconds))]),n("i",[t._v(t._s(t.secondsTxt))])]):t._e()])},s=[],i=(n("6b54"),n("c5f6"),{replace:!0,data:function(){return{tipShow:!0,msTime:{show:!1,day:"",hour:"",minutes:"",seconds:""},star:"",end:"",current:""}},watch:{currentTime:function(t,e){this.gogogo()}},props:{tipText:{type:String,default:"距离开始"},tipTextEnd:{type:String,default:"距离结束"},id:{type:String,default:"1"},currentTime:{type:Number},startTime:{type:Number},endTime:{type:Number},endText:{type:String,default:"已结束"},dayTxt:{type:String,default:":"},hourTxt:{type:String,default:":"},minutesTxt:{type:String,default:":"},secondsTxt:{type:String,default:":"},secondsFixed:{type:Boolean,default:!1}},mounted:function(){console.log(this),this.gogogo()},methods:{gogogo:function(){var t=this;10==this.startTime.toString().length?this.star=1e3*this.startTime:this.star=this.startTime,10==this.endTime.toString().length?this.end=1e3*this.endTime:this.end=this.endTime,this.currentTime?10==this.currentTime.toString().length?this.current=1e3*this.currentTime:this.current=this.currentTime:this.current=(new Date).getTime(),this.end<this.current?(this.msTime.show=!1,this.end_message()):this.current<this.star?(this.$set(this,"tipShow",!0),setTimeout((function(){t.runTime(t.star,t.current,t.start_message)}),1)):(this.end>this.current&&this.star<this.current||this.star==this.current)&&(this.$set(this,"tipShow",!1),this.msTime.show=!0,this.$emit("start_callback",this.msTime.show),setTimeout((function(){t.runTime(t.end,t.star,t.end_message,!0)}),1))},runTime:function(t,e,n,a){var s=this,i=this.msTime,r=t-e;if(r>0){this.msTime.show=!0,i.day=Math.floor(r/864e5),r-=864e5*i.day,i.hour=Math.floor(r/36e5),r-=36e5*i.hour,i.minutes=Math.floor(r/6e4),r-=6e4*i.minutes,i.seconds=Math.floor(r/1e3).toFixed(0),r-=1e3*i.seconds,i.hour<10&&(i.hour="0"+i.hour),i.minutes<10&&(i.minutes="0"+i.minutes),i.seconds<10&&(i.seconds="0"+i.seconds);var o=Date.now(),c=Date.now(),u=c-o;setTimeout((function(){a?s.runTime(s.end,e+=1e3,n,!0):s.runTime(s.star,e+=1e3,n)}),1e3-u)}else n()},start_message:function(){var t=this;this.$set(this,"tipShow",!1),this.$emit("start_callback",this.msTime.show),setTimeout((function(){t.runTime(t.end,t.star,t.end_message,!0)}),1)},end_message:function(){this.msTime.show=!1,this.currentTime<=0||this.$emit("end_callback",this.msTime.show)}}}),r=i,o=n("2877"),c=Object(o["a"])(r,a,s,!1,null,null,null);e["default"]=c.exports},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-7a2ab302.6596a36f.js.map