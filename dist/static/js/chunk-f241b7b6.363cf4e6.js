(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f241b7b6"],{"02f4":function(e,t,a){var l=a("4588"),i=a("be13");e.exports=function(e){return function(t,a){var s,n,o=String(i(t)),r=l(a),u=o.length;return r<0||r>=u?e?"":void 0:(s=o.charCodeAt(r),s<55296||s>56319||r+1===u||(n=o.charCodeAt(r+1))<56320||n>57343?e?o.charAt(r):s:e?o.slice(r,r+2):n-56320+(s-55296<<10)+65536)}}},"0390":function(e,t,a){"use strict";var l=a("02f4")(!0);e.exports=function(e,t,a){return t+(a?l(e,t).length:1)}},"0415":function(e,t,a){},"0cef":function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return s})),a.d(t,"j",(function(){return n})),a.d(t,"e",(function(){return o})),a.d(t,"f",(function(){return r})),a.d(t,"a",(function(){return u})),a.d(t,"h",(function(){return c})),a.d(t,"g",(function(){return d})),a.d(t,"i",(function(){return p})),a.d(t,"b",(function(){return f}));var l=a("b775");function i(e){return Object(l["a"])({url:"/layout/",method:"post",headers:{"Content-Type":"multipart/form-data"},data:e})}function s(e){return Object(l["a"])({url:"/layout/"+e+"/delete/"})}function n(e){return Object(l["a"])({url:"/img/upload/",method:"post",headers:{"Content-Type":"multipart/form-data"},data:e})}function o(e,t,a){return void 0!==t&&null!==t||(t=1),void 0!==e&&null!=e||(e=""),void 0!==a&&null!==a&&""!==a||(a=""),Object(l["a"])({url:"/layout/?query="+e+"&page="+t+"&flag="+a,method:"get"})}function r(e){return Object(l["a"])({url:"/layout/"+e+"/release/",method:"get"})}function u(e){return Object(l["a"])({url:"build/compose/",method:"post",data:e})}function c(e){return Object(l["a"])({url:"update/compose/",method:"post",data:e})}function d(){return Object(l["a"])({url:"show/compose/",method:"get"})}function p(e){return Object(l["a"])({url:"/file/upload/",method:"post",headers:{"Content-Type":"multipart/form-data"},data:e})}function f(e){return Object(l["a"])({url:"/file/delete/",method:"post",headers:{"Content-Type":"multipart/form-data"},data:e})}},"153a":function(e,t,a){"use strict";a("9211")},"16d8":function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:e.id}})},i=[],s=a("db72"),n=(a("a7be"),a("44f8"),a("a6e0"),a("2c43"),a("bff0"),a("1487"),a("547e")),o=a.n(n),r={minHeight:"500px",previewStyle:"vertical",useCommandShortcut:!0,useDefaultHTMLSanitizer:!0,usageStatistics:!1,hideModeSwitch:!1,viewer:!0,toolbarItems:["heading","bold","italic","strike","divider","hr","quote","divider","ul","ol","task","indent","outdent","divider","table","image","link","divider","code","codeblock"]},u={name:"MarkdownEditor",props:{value:{type:String,default:""},id:{type:String,required:!1,default:function(){return"markdown-editor-"+ +new Date+(1e3*Math.random()).toFixed(0)}},options:{type:Object,default:function(){return r}},mode:{type:String,default:"markdown"},height:{type:String,required:!1,default:"300px"},language:{type:String,required:!1,default:"en_US"}},data:function(){return{editor:null}},computed:{editorOptions:function(){var e=Object.assign({},r,this.options);return e.initialEditType=this.mode,e.height=this.height,e.language=this.language,e}},watch:{value:function(e,t){e!==t&&e!==this.editor.getValue()&&this.editor.setValue(e)},language:function(e){this.destroyEditor(),this.initEditor()},height:function(e){this.editor.height(e)},mode:function(e){this.editor.changeMode(e)}},mounted:function(){this.initEditor()},destroyed:function(){this.destroyEditor()},methods:{initEditor:function(){var e=this;this.editor=new o.a(Object(s["a"])({el:document.getElementById(this.id)},this.editorOptions)),this.value&&this.editor.setValue(this.value),this.editor.on("change",(function(){e.$emit("input",e.editor.getValue())}))},destroyEditor:function(){this.editor&&(this.editor.off("change"),this.editor.remove())},setValue:function(e){this.editor.setValue(e)},getValue:function(){return this.editor.getValue()},setHtml:function(e){this.editor.setHtml(e)},getHtml:function(){return this.editor.getHtml()}}},c=u,d=a("2877"),p=Object(d["a"])(c,l,i,!1,null,null,null);t["a"]=p.exports},"4dd0":function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return s})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return o}));var l=a("b775");function i(e,t,a){return void 0!==t&&null!==t||(t=1),void 0!==a&&null!=a||(a=""),Object(l["a"])({url:"/container/?flag="+e+"&page="+t+"&image_id="+a,method:"get"})}function s(e){return Object(l["a"])({url:"/container/"+e+"/stop/?flag=list",method:"get"})}function n(e){return Object(l["a"])({url:"/container/"+e+"/start/?flag=list",method:"get"})}function o(e){return Object(l["a"])({url:"/container/"+e+"/delete/?flag=list",method:"delete"})}},5969:function(e,t,a){"use strict";a("0415")},9211:function(e,t,a){},a481:function(e,t,a){"use strict";var l=a("cb7c"),i=a("4bf8"),s=a("9def"),n=a("4588"),o=a("0390"),r=a("5f1b"),u=Math.max,c=Math.min,d=Math.floor,p=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g,m=function(e){return void 0===e?e:String(e)};a("214f")("replace",2,(function(e,t,a,v){return[function(l,i){var s=e(this),n=void 0==l?void 0:l[t];return void 0!==n?n.call(l,s,i):a.call(String(s),l,i)},function(e,t){var i=v(a,e,this,t);if(i.done)return i.value;var d=l(e),p=String(this),f="function"===typeof t;f||(t=String(t));var h=d.global;if(h){var b=d.unicode;d.lastIndex=0}var _=[];while(1){var y=r(d,p);if(null===y)break;if(_.push(y),!h)break;var k=String(y[0]);""===k&&(d.lastIndex=o(p,s(d.lastIndex),b))}for(var w="",I=0,S=0;S<_.length;S++){y=_[S];for(var x=String(y[0]),C=u(c(n(y.index),p.length),0),L=[],V=1;V<y.length;V++)L.push(m(y[V]));var T=y.groups;if(f){var D=[x].concat(L,C,p);void 0!==T&&D.push(T);var O=String(t.apply(void 0,D))}else O=g(x,p,C,L,T,t);C>=I&&(w+=p.slice(I,C)+O,I=C+x.length)}return w+p.slice(I)}];function g(e,t,l,s,n,o){var r=l+e.length,u=s.length,c=f;return void 0!==n&&(n=i(n),c=p),a.call(o,c,(function(a,i){var o;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,l);case"'":return t.slice(r);case"<":o=n[i.slice(1,-1)];break;default:var c=+i;if(0===c)return a;if(c>u){var p=d(c/10);return 0===p?a:p<=u?void 0===s[p-1]?i.charAt(1):s[p-1]+i.charAt(1):a}o=s[c-1]}return void 0===o?"":o}))}}))},e036:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-dialog",{attrs:{visible:e.centerDialogVisible,title:"添加",width:"65%"},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[a("el-tabs",{attrs:{value:"add"},on:{"tab-click":e.handleClick}},[a("el-tab-pane",{attrs:{name:"add",label:"添加"}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"label-width":"80px","element-loading-text":"添加中"}},[a("el-form-item",{attrs:{label:"漏洞名称"}},[a("el-input",{attrs:{size:"medium"},model:{value:e.vulInfo.vul_name,callback:function(t){e.$set(e.vulInfo,"vul_name",t)},expression:"vulInfo.vul_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"镜像"}},[a("el-col",{attrs:{span:17}},["file"===e.imgType?a("el-upload",{ref:"upload",attrs:{"http-request":e.uploadImg,accept:".tar",action:"/CombinationImage/",limit:1,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"medium",type:"primary"},slot:"trigger"},[e._v("选取文件")])],1):e._e(),e._v(" "),"text"===e.imgType?a("el-autocomplete",{staticStyle:{width:"100%"},attrs:{size:"medium","fetch-suggestions":e.querySearchAsync},on:{select:e.handleSelect},model:{value:e.vulInfo.name,callback:function(t){e.$set(e.vulInfo,"name",t)},expression:"vulInfo.name"}}):e._e()],1),e._v(" "),a("el-col",{staticStyle:{float:"right",right:"0"},attrs:{span:5}},[a("el-button",{attrs:{size:"medium"},on:{click:function(t){return t.stopPropagation(),e.changeType(t)}},model:{value:e.imgType,callback:function(t){e.imgType=t},expression:"imgType"}},[e._v(e._s(e.imgTypeText))])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"标签"}},[a("div",{staticClass:"tag-group"},[a("el-row",[a("el-col",{attrs:{span:2.5}},[a("el-button",{staticClass:"tag-group__title",staticStyle:{width:"80px"},attrs:{type:"primary",size:"mini"}},[e._v("漏洞类型")])],1),e._v(" "),e._l(e.vulInfo.HoleType,(function(t,l){return a("el-tag",{key:l,staticStyle:{"margin-left":"10px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.handleClose(t,"HoleType","newtag")}}},[e._v("\n                      "+e._s(t)+"\n                    ")])})),e._v(" "),e.inputVisible1?a("el-autocomplete",{ref:"saveTagInput1",attrs:{"popper-class":"my-autocomplete","fetch-suggestions":function(t,a){e.querySearch(t,a,e.type="inputValue1")},placeholder:"请输入内容"},on:{select:e.handleSel},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm1("newtag")}},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.item;return[a("div",{staticClass:"name"},[e._v(e._s(l.value))])]}}],null,!1,3425812505),model:{value:e.inputValue1,callback:function(t){e.inputValue1=t},expression:"inputValue1"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput1}},[e._v("+ New Tag")])],2)],1),e._v(" "),a("div",{staticClass:"tag-group"},[a("el-row",[a("el-col",{attrs:{span:2.5}},[a("el-button",{staticClass:"tag-group__title",staticStyle:{width:"80px"},attrs:{type:"primary",size:"mini"}},[e._v("开发语言")])],1),e._v(" "),e._l(e.vulInfo.devLanguage,(function(t,l){return a("el-tag",{key:l,staticStyle:{"margin-left":"10px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.handleClose(t,"devLanguage","newtag")}}},[e._v("\n                    "+e._s(t)+"\n                    ")])})),e._v(" "),e.inputVisible2?a("el-autocomplete",{ref:"saveTagInput2",attrs:{"popper-class":"my-autocomplete","fetch-suggestions":function(t,a){e.querySearch(t,a,e.type="inputValue2")},placeholder:"请输入内容"},on:{select:e.handleSel},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm2("newtag")}},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.item;return[a("div",{staticClass:"name"},[e._v(e._s(l.value))])]}}],null,!1,3425812505),model:{value:e.inputValue2,callback:function(t){e.inputValue2=t},expression:"inputValue2"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput2}},[e._v("+ New Tag")])],2)],1),e._v(" "),a("div",{staticClass:"tag-group"},[a("el-row",[a("el-col",{attrs:{span:2.5}},[a("el-button",{staticClass:"tag-group__title",staticStyle:{width:"80px"},attrs:{type:"primary",size:"mini"}},[e._v("数据库")])],1),e._v(" "),e._l(e.vulInfo.devDatabase,(function(t,l){return a("el-tag",{key:l,staticStyle:{"margin-left":"10px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.handleClose(t,"devDatabase","newtag")}}},[e._v("\n                    "+e._s(t)+"\n                    ")])})),e._v(" "),e.inputVisible3?a("el-autocomplete",{ref:"saveTagInput3",attrs:{"popper-class":"my-autocomplete","fetch-suggestions":function(t,a){e.querySearch(t,a,e.type="inputValue3")},placeholder:"请输入内容"},on:{select:e.handleSel},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm3("newtag")}},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.item;return[a("div",{staticClass:"name"},[e._v(e._s(l.value))])]}}],null,!1,3425812505),model:{value:e.inputValue3,callback:function(t){e.inputValue3=t},expression:"inputValue3"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput3}},[e._v("+ New Tag")])],2)],1),e._v(" "),a("div",{staticClass:"tag-group"},[a("el-row",[a("el-col",{attrs:{span:2.5}},[a("el-button",{staticClass:"tag-group__title",staticStyle:{width:"80px"},attrs:{type:"primary",size:"mini"}},[e._v("分类")])],1),e._v(" "),e._l(e.vulInfo.devClassify,(function(t,l){return a("el-tag",{key:l,staticStyle:{"margin-left":"10px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.handleClose(t,"devClassify","newtag")}}},[e._v("\n                    "+e._s(t)+"\n                    ")])})),e._v(" "),e.inputVisible4?a("el-autocomplete",{ref:"saveTagInput4",attrs:{"popper-class":"my-autocomplete","fetch-suggestions":function(t,a){e.querySearch(t,a,e.type="inputValue4")},placeholder:"请输入内容"},on:{select:e.handleSel},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm4("newtag")}},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.item;return[a("div",{staticClass:"name"},[e._v(e._s(l.value))])]}}],null,!1,3425812505),model:{value:e.inputValue4,callback:function(t){e.inputValue4=t},expression:"inputValue4"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput4}},[e._v("+ New Tag")])],2)],1)]),e._v(" "),a("el-form-item",{attrs:{label:"Rank"}},[a("el-input-number",{attrs:{min:.5,max:5,precision:1,step:.5,size:"medium"},model:{value:e.vulInfo.rank,callback:function(t){e.$set(e.vulInfo,"rank",t)},expression:"vulInfo.rank"}}),e._v(" "),a("el-tooltip",{attrs:{content:"默认分数为2.5分，可根据漏洞的利用难度进行评判",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea",size:"medium"},model:{value:e.vulInfo.desc,callback:function(t){e.$set(e.vulInfo,"desc",t)},expression:"vulInfo.desc"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"flag"}},[a("el-switch",{model:{value:e.vulInfo.is_flag,callback:function(t){e.$set(e.vulInfo,"is_flag",t)},expression:"vulInfo.is_flag"}}),e._v(" "),a("el-tooltip",{attrs:{content:"是否开启flag",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.uploadImg}},[e._v("提 交")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.handleMark}},[e._v("编辑writeup")])],1),e._v(" "),!0===e.markstatus?a("el-form-item",[a("div",{staticClass:"container"},[a("markdown-editor",{ref:"markdownEditor",attrs:{options:{hideModeSwitch:!0,previewStyle:"tab"},height:"200px"},model:{value:e.vulInfo.writeup_date,callback:function(t){e.$set(e.vulInfo,"writeup_date",t)},expression:"vulInfo.writeup_date"}})],1),e._v(" "),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.closeHandleMark}},[e._v("关闭")])],1):e._e()],1)],1),e._v(" "),a("el-tab-pane",{attrs:{name:"local",label:"本地导入"}},[a("div",{staticClass:"filter-container"},[a("el-input",{staticStyle:{width:"230px"},attrs:{size:"medium"},model:{value:e.localSearch,callback:function(t){e.localSearch=t},expression:"localSearch"}}),e._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px","margin-bottom":"10px"},attrs:{size:"medium",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.batchLocalAdd}},[e._v("\n                一键导入\n              ")]),e._v("   \n              "),a("el-tooltip",{attrs:{content:"一键导入默认导入分数为 2.5 分,漏洞名称为镜像名称,漏洞描述为漏洞名称",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.localLoading,expression:"localLoading"}],staticStyle:{width:"100%"},attrs:{data:e.localImageList.filter((function(t){return!e.localSearch||t.name.toLowerCase().includes(e.localSearch.toLowerCase())})),"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectLocalImages}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"标签",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[!0===l.flag?a("el-tag",{attrs:{effect:"dark",type:"info"}},[e._v("已导入")]):!1===l.flag?a("el-tag",{attrs:{effect:"dark"}},[e._v("未导入")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-button",{attrs:{type:"danger",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLocalRemove(l.name)}}},[e._v("移除")])]}}])})],1)],1),e._v(" "),a("el-tab-pane",{attrs:{name:"addcompose",label:"Compose编译"}},[a("compose")],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.progressShow,title:e.progress.title,width:"60%","before-close":e.closeProgress},on:{"update:visible":function(t){e.progressShow=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.progressLoading,expression:"progressLoading"}]},e._l(e.progress.layer,(function(t,l){return a("el-row",{staticStyle:{"margin-bottom":"10px",height:"24px"}},[a("el-tag",{staticStyle:{float:"left",width:"15%",height:"24px","line-height":"24px"},attrs:{align:"center"}},[e._v(e._s(t.id))]),e._v(" "),a("div",{staticStyle:{float:"left",width:"80%","margin-left":"10px"}},[100===t.progress?a("el-progress",{attrs:{percentage:t.progress,"text-inside":!0,"stroke-width":24,status:"success"}}):a("el-progress",{attrs:{percentage:t.progress,"text-inside":!0,"stroke-width":24}})],1)],1)})),1)]),e._v(" "),a("el-dialog",{attrs:{visible:e.deleteShow,title:"删除",width:"80%"},on:{"update:visible":function(t){e.deleteShow=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.deleteContainerList,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"vul_name",width:"150","show-overflow-tooltip":!0,label:"漏洞名称"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"user_name",width:"100",label:"用户名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"vul_host",width:"200","show-overflow-tooltip":!0,label:"访问地址"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"85"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-tag",[e._v(e._s(l.container_status))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"vul_desc","show-overflow-tooltip":!0,width:"300",label:"漏洞描述"}}),e._v(" "),a("el-table-column",{attrs:{prop:"combination_desc",label:"操作","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return["running"===l.container_status||"stop"===l.container_status?a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.delContainer(l)}}},[e._v("删除")]):e._e()]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.editShow},on:{"update:visible":function(t){e.editShow=t},close:e.closeDialog}},[a("el-tabs",[a("el-tab-pane",{attrs:{label:"修改"}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.editLoding,expression:"editLoding"}],attrs:{"label-width":"80px","element-loading-text":"修改中"}},[a("el-form-item",{attrs:{label:"漏洞名称"}},[a("el-input",{attrs:{size:"medium"},model:{value:e.editVulInfo.image_vul_name,callback:function(t){e.$set(e.editVulInfo,"image_vul_name",t)},expression:"editVulInfo.image_vul_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"镜像"}},[a("el-input",{attrs:{disabled:""},model:{value:e.editVulInfo.image_name,callback:function(t){e.$set(e.editVulInfo,"image_name",t)},expression:"editVulInfo.image_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"标签"}},[a("div",{staticClass:"tag-group"},[a("el-row",[a("el-col",{attrs:{span:2.5}},[a("el-button",{staticClass:"tag-group__title",staticStyle:{width:"80px"},attrs:{type:"primary",size:"mini"}},[e._v("漏洞类型")])],1),e._v(" "),e._l(e.editVulInfo.HoleType,(function(t,l){return a("el-tag",{key:l,staticStyle:{"margin-left":"10px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.handleClose(t,"HoleType")}}},[e._v("\n                  "+e._s(t)+"\n                ")])})),e._v(" "),e.inputVisible1?a("el-autocomplete",{ref:"saveTagInput1",attrs:{"popper-class":"my-autocomplete","fetch-suggestions":function(t,a){e.querySearch(t,a,e.type="inputValue1")},placeholder:"请输入内容"},on:{select:e.handleSel},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm1(t)}},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.item;return[a("div",{staticClass:"name"},[e._v(e._s(l.value))])]}}],null,!1,3425812505),model:{value:e.inputValue1,callback:function(t){e.inputValue1=t},expression:"inputValue1"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput1}},[e._v("+ New Tag")])],2)],1),e._v(" "),a("div",{staticClass:"tag-group"},[a("el-row",[a("el-col",{attrs:{span:2.5}},[a("el-button",{staticClass:"tag-group__title",staticStyle:{width:"80px"},attrs:{type:"primary",size:"mini"}},[e._v("开发语言")])],1),e._v(" "),e._l(e.editVulInfo.devLanguage,(function(t,l){return a("el-tag",{key:l,staticStyle:{"margin-left":"10px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.handleClose(t,"devLanguage")}}},[e._v("\n                "+e._s(t)+"\n                ")])})),e._v(" "),e.inputVisible2?a("el-autocomplete",{ref:"saveTagInput2",attrs:{"popper-class":"my-autocomplete","fetch-suggestions":function(t,a){e.querySearch(t,a,e.type="inputValue2")},placeholder:"请输入内容"},on:{select:e.handleSel},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm2(t)}},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.item;return[a("div",{staticClass:"name"},[e._v(e._s(l.value))])]}}],null,!1,3425812505),model:{value:e.inputValue2,callback:function(t){e.inputValue2=t},expression:"inputValue2"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput2}},[e._v("+ New Tag")])],2)],1),e._v(" "),a("div",{staticClass:"tag-group"},[a("el-row",[a("el-col",{attrs:{span:2.5}},[a("el-button",{staticClass:"tag-group__title",staticStyle:{width:"80px"},attrs:{type:"primary",size:"mini"}},[e._v("数据库")])],1),e._v(" "),e._l(e.editVulInfo.devDatabase,(function(t,l){return a("el-tag",{key:l,staticStyle:{"margin-left":"10px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.handleClose(t,"devDatabase")}}},[e._v("\n                "+e._s(t)+"\n                ")])})),e._v(" "),e.inputVisible3?a("el-autocomplete",{ref:"saveTagInput3",attrs:{"popper-class":"my-autocomplete","fetch-suggestions":function(t,a){e.querySearch(t,a,e.type="inputValue3")},placeholder:"请输入内容"},on:{select:e.handleSel},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm3(t)}},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.item;return[a("div",{staticClass:"name"},[e._v(e._s(l.value))])]}}],null,!1,3425812505),model:{value:e.inputValue3,callback:function(t){e.inputValue3=t},expression:"inputValue3"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput3}},[e._v("+ New Tag")])],2)],1),e._v(" "),a("div",{staticClass:"tag-group"},[a("el-row",[a("el-col",{attrs:{span:2.5}},[a("el-button",{staticClass:"tag-group__title",staticStyle:{width:"80px"},attrs:{type:"primary",size:"mini"}},[e._v("分类")])],1),e._v(" "),e._l(e.editVulInfo.devClassify,(function(t,l){return a("el-tag",{key:l,staticStyle:{"margin-left":"10px"},attrs:{closable:"","disable-transitions":!1},on:{close:function(a){return e.handleClose(t,"devClassify")}}},[e._v("\n                "+e._s(t)+"\n                ")])})),e._v(" "),e.inputVisible4?a("el-autocomplete",{ref:"saveTagInput4",attrs:{"popper-class":"my-autocomplete","fetch-suggestions":function(t,a){e.querySearch(t,a,e.type="inputValue4")},placeholder:"请输入内容"},on:{select:e.handleSel},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm4(t)}},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.item;return[a("div",{staticClass:"name"},[e._v(e._s(l.value))])]}}],null,!1,3425812505),model:{value:e.inputValue4,callback:function(t){e.inputValue4=t},expression:"inputValue4"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput4}},[e._v("+ New Tag")])],2)],1)]),e._v(" "),a("el-form-item",{attrs:{label:"Rank"}},[a("el-input-number",{attrs:{min:.5,max:5,precision:1,step:.5,size:"medium"},model:{value:e.editVulInfo.rank,callback:function(t){e.$set(e.editVulInfo,"rank",t)},expression:"editVulInfo.rank"}}),e._v(" "),a("el-tooltip",{attrs:{content:"默认分数为2.5分，可根据漏洞的利用难度进行评判",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"Flag"}},[a("el-switch",{model:{value:e.editVulInfo.is_flag,callback:function(t){e.$set(e.editVulInfo,"is_flag",t)},expression:"editVulInfo.is_flag"}}),e._v(" "),a("el-tooltip",{attrs:{content:"是否开启flag",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea",size:"medium"},model:{value:e.editVulInfo.image_desc,callback:function(t){e.$set(e.editVulInfo,"image_desc",t)},expression:"editVulInfo.image_desc"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.handleEditImage}},[e._v("提 交")])],1)],1)],1),e._v(" "),!0===e.editVulInfo.is_docker_compose?a("el-tab-pane",{attrs:{id:"compose-update",label:"Compose修改"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-document"}),e._v("DockerCompose修改")]),e._v(" "),a("el-tabs",{ref:"tab",attrs:{value:"dockerfile"}},[a("el-tab-pane",{attrs:{name:"dockerfile"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-edit"}),e._v(" DockerCompose.yml")]),e._v(" "),a("div",[a("el-form",[a("el-form-item",[a("el-input",{attrs:{type:"textarea",rows:"10",placeholder:"Define or paste the content of Your DockerCompose.yml here"},model:{value:e.compose_content,callback:function(t){e.compose_content=t},expression:"compose_content"}})],1)],1)],1)])],1),e._v(" "),a("div",[a("el-row",[a("el-col",{attrs:{span:2}},[a("div",{staticClass:"action-group"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.update_compose_build}},[e._v("编译")])],1)]),e._v(" "),a("el-col",{staticStyle:{"margin-top":"0px"},attrs:{span:22}},[a("div",[a("el-upload",{ref:"upload",attrs:{"http-request":e.upload,"max-size":2048,action:"/CombinationImage/","before-upload":e.beforeAvatarUpload,"on-remove":e.removeChange,"on-change":e.handleChange,"file-list":e.fileList}},[a("el-button",{staticStyle:{"margin-bottom":"20px"},attrs:{slot:"trigger",size:"mini",type:"primary"},slot:"trigger"},[e._v("上传文件")])],1)],1)])],1)],1)],1):e._e()],1)],1),e._v(" "),a("div",{staticClass:"filter-container"},[a("el-input",{staticStyle:{width:"230px"},attrs:{size:"medium"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px","margin-bottom":"10px"},attrs:{size:"medium",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.handleQuery(1)}}},[e._v("\n        查询\n      ")]),e._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px","margin-bottom":"10px"},attrs:{size:"medium",type:"primary",icon:"el-icon-edit"},on:{click:e.openCreate}},[e._v("\n        添加\n      ")]),e._v(" "),!1===e.loading?a("el-button",{staticClass:"filter-item",staticStyle:{float:"right","margin-bottom":"10px"},attrs:{size:"medium",type:"primary",icon:"el-icon-refresh-left"},on:{click:e.getWebsiteData}},[e._v("\n        一键同步\n      ")]):!0===e.loading?a("el-button",{staticStyle:{float:"right","margin-bottom":"10px"},attrs:{type:"primary",loading:!0}},[e._v("同步中")]):e._e()],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tabLoading,expression:"tabLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:"",align:"center"}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"image_name",label:"镜像名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"image_vul_name",label:"漏洞名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"image_port",label:"端口",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"rank",label:"分数",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"标签",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return l.degree.length>0&&""!==l.degree?e._l(l.degree,(function(t){return a("el-tag",{staticStyle:{"margin-left":"2px"}},[e._v(e._s(t))])})):void 0}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{prop:"image_desc","show-overflow-tooltip":!0,label:"描述"}}),e._v(" "),a("el-table-column",{attrs:{prop:"update_date","show-overflow-tooltip":!0,label:"修改时间"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[!1===l.is_ok&&""!==l.status.task_id?a("el-tag",{staticStyle:{display:"inline-block",float:"left","line-height":"28px",height:"28px","margin-left":"5px"},attrs:{effect:"dark"},on:{click:function(t){return e.openProgress(l,1)}}},[a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("span",[e._v("下载中")])]),e._v(" "),a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("el-progress",{staticStyle:{"margin-left":"3px","margin-top":"3px"},attrs:{type:"circle","stroke-width":3,"show-text":!1,"text-inside":!1,percentage:l.status.progress,width:20}})],1)]):!1===l.is_ok&&""===l.status.task_id?a("el-button",{staticStyle:{display:"inline-block",float:"left","margin-left":"5px"},attrs:{size:"mini",type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.downloadImg(l)}}},[e._v("下载")]):e._e(),e._v(" "),!0===l.is_ok||!1===l.is_ok&&""===l.status.task_id?a("el-button",{staticStyle:{display:"inline-block",float:"left","margin-left":"5px"},attrs:{size:"mini",icon:"el-icon-edit",type:"primary"},on:{click:function(t){return e.openEdit(l)}}},[e._v("修改")]):e._e(),e._v(" "),!0===l.is_ok||!1===l.is_ok&&""===l.status.task_id?a("el-button",{staticStyle:{display:"inline-block",float:"left","margin-left":"5px"},attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.handleDelete(l)}}},[e._v("删除")]):e._e(),e._v(" "),!0===l.is_ok&&!0===l.is_share?a("el-tag",{staticStyle:{display:"inline-block",float:"left","line-height":"28px",height:"28px","margin-left":"5px"},attrs:{type:"success",effect:"dark"}},[a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("span",[e._v("已分享")])])]):e._e(),e._v(" "),!0===l.is_ok&&!1===l.is_share&&"share"!==l.status.progress_status?a("el-button",{staticStyle:{display:"inline-block",float:"left","margin-left":"5px"},attrs:{size:"mini",type:"primary",icon:"el-icon-share"},on:{click:function(t){return e.shareImg(l)}}},[e._v("分享")]):e._e(),e._v(" "),!0===l.is_ok&&"share"===l.status.progress_status?a("el-tag",{staticStyle:{display:"inline-block",float:"left","line-height":"28px",height:"28px","margin-left":"5px"},attrs:{effect:"dark"},on:{click:function(t){return e.openProgress(l,2)}}},[a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("span",[e._v("分享中")])]),e._v(" "),a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("el-progress",{staticStyle:{"margin-left":"3px","margin-top":"3px"},attrs:{type:"circle","stroke-width":3,"show-text":!1,"text-inside":!1,percentage:l.status.progress,width:20}})],1)]):e._e()]}}])})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-pagination",{attrs:{"page-size":e.page.size,layout:"total, prev, pager, next, jumper",total:e.page.total},on:{"current-change":e.handleQuery}})],1)],1)},i=[],s=(a("386d"),a("a481"),a("7f7f"),a("ac6a"),a("3007")),n=a("bc3a"),o=a.n(n);function r(e){var t="https://hub.docker.com/api/content/v1/products/search?page_size=50&q=vulfocus%2F"+e+"&type=image";return o()({method:"get",url:t,headers:{"Sec-Fetch-Site":"none","Sec-Fetch-Mode":"cors","Sec-Fetch-Dest":"empty","Accept-Encoding":"gzip, deflate","Accept-Language":"zh-CN,zh;q=0.9","Search-Version":"v3"}})}var u=a("b775");function c(e){return Object(u["a"])({url:"/images/",method:"post",headers:{"Content-Type":"multipart/form-data"},data:e})}function d(e,t){return Object(u["a"])({url:"/images/"+e+"/edit/",method:"post",data:t})}function p(e){return Object(u["a"])({url:"/images/"+e+"/delete/"})}function f(){return Object(u["a"])({url:"/images/local/local/"})}function m(e){return Object(u["a"])({url:"/images/local/local_add/",method:"post",data:e})}function v(e){return Object(u["a"])({url:"/images/"+e+"/download/"})}function g(e){return Object(u["a"])({url:"/images/"+e+"/share/"})}var h=a("4dd0"),b=a("ea7f"),_=a("16d8"),y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"widget"},[a("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"border-card","element-loading-text":"正在安装相关镜像","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.1)"}},[a("el-tab-pane",{attrs:{id:"ceshi"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-document"}),e._v("DockerCompose")]),e._v(" "),a("el-form",{ref:"build",attrs:{model:e.composeForm,inline:"",size:"mini",rules:e.rules}},[a("el-form-item",{attrs:{label:"名称",prop:"tag1"}},[a("el-input",{attrs:{placeholder:"eg. redis:latest"},model:{value:e.composeForm.tag1,callback:function(t){e.$set(e.composeForm,"tag1",t)},expression:"composeForm.tag1"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Rank"}},[a("el-input-number",{attrs:{min:0,max:5,precision:1,step:.5,size:"mini"},model:{value:e.composeForm.rank,callback:function(t){e.$set(e.composeForm,"rank",t)},expression:"composeForm.rank"}}),e._v(" "),a("el-tooltip",{attrs:{content:"默认分数为2.5分，可根据漏洞的利用难度进行评判",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"flag"}},[a("el-switch",{model:{value:e.composeForm.is_flag,callback:function(t){e.$set(e.composeForm,"is_flag",t)},expression:"composeForm.is_flag"}}),e._v(" "),a("el-tooltip",{attrs:{content:"是否开启flag",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1)],1),e._v(" "),a("el-tabs",{ref:"tab",attrs:{value:"dockerfile"}},[a("el-tab-pane",{attrs:{name:"dockerfile"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"el-icon-edit"}),e._v(" DockerCompose.yml")]),e._v(" "),a("div",[a("el-form",[a("el-form-item",[a("el-input",{attrs:{type:"textarea",rows:"10",placeholder:"Define or paste the content of Your DockerCompose.yml here"},model:{value:e.compose_content,callback:function(t){e.compose_content=t},expression:"compose_content"}})],1)],1)],1)])],1),e._v(" "),a("div",[a("el-row",[a("el-col",{attrs:{span:2}},[a("div",{staticClass:"action-group"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.compose_build}},[e._v("编译")])],1)]),e._v(" "),a("el-col",{staticStyle:{"margin-top":"10px"},attrs:{span:22}},[a("div",[a("el-upload",{ref:"upload",attrs:{"http-request":e.upload,"max-size":2048,action:"/CombinationImage/","before-upload":e.beforeAvatarUpload,"on-remove":e.removeChange,"on-change":e.handleChange,"file-list":e.fileList}},[a("el-button",{staticStyle:{"margin-bottom":"20px"},attrs:{slot:"trigger",size:"mini",type:"primary"},slot:"trigger"},[e._v("上传文件")])],1)],1)])],1)],1)],1)],1)],1)])},k=[],w=a("0cef"),I={inject:["reload"],data:function(){return{rules:{tag:[{required:!0,max:100,min:2,message:"请输入要构建的镜像名称"}],tag1:[{required:!0,max:100,min:2,message:"请输入要构建的镜像名称"}]},selectHub:"DockerHub",imageName:"",buildForm:{tag:""},composeForm:{tag1:"",rank:"",degree:[],is_flag:!0},options:[{value:"DockerHub",label:"DockerHub"}],file:null,output:[],pk:null,content:"",compose_content:"",listTotal:0,listData:[],showLog:!1,loading:!1,newFile:new FormData,fileList:[],degreeList:[{value:"命令执行",lable:"命令执行"},{value:"代码执行",lable:"代码执行"},{value:"文件写入",lable:"文件写入"},{value:"文件上传",lable:"文件上传"},{value:"后门",lable:"后门"},{value:"默认口令",lable:"默认口令"},{value:"弱口令",lable:"弱口令"},{value:"权限绕过",lable:"权限绕过"},{value:"未授权访问",lable:"未授权访问"},{value:"XXE漏洞",lable:"XXE漏洞"},{value:"SQL注入",lable:"SQL注入"},{value:"文件读取",lable:"文件读取"},{value:"文件下载",lable:"文件下载"},{value:"文件包含",lable:"文件包含"},{value:"文件删除",lable:"文件删除"},{value:"目录遍历",lable:"目录遍历"},{value:"信息泄漏",lable:"信息泄漏"},{value:"任意账户操作",lable:"任意账户操作"},{value:"XSS漏洞",lable:"XSS漏洞"},{value:"SSRF漏洞",lable:"SSRF漏洞"},{value:"CSRF漏洞",lable:"CSRF漏洞"}]}},created:function(){},methods:{showCompose:function(){var e=this;Object(w["g"])().then((function(t){if(200===t.data.code){var a=t.data["data"],l=t.data["img_name"];e.compose_content=a,e.composeForm.tag1=l,e.loading=!0}}))},removeChange:function(e,t){var a=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var l=new FormData;l.set("file",e.name),Object(w["b"])(l).then((function(l){var i=l.data;if(200===i.status){for(var s=0;s<t.length;s++)t[s]===e&&t.splice(s,1);a.$message({type:"success",message:"删除成功!"})}else t.push(e),a.$message({type:"error",message:"删除失败!"})}))})).catch((function(){t.push(e),a.$message({type:"info",message:"已取消删除"})}))},compose_build:function(){var e=this,t={};t.compose_content=this.compose_content,t.tag=this.composeForm.tag1,t.rank=this.composeForm.rank,t.degree=this.composeForm.degree,t.is_flag=this.composeForm.is_flag,Object(w["a"])(t).then((function(t){200===t.data.code?(e.$message({title:"构建任务创建成功",message:t.data.message,type:"success"}),e.reload()):e.$message({title:"构建任务创建失败",message:t.data.message,type:"error"})}))},beforeAvatarUpload:function(e){if(!e)return!1;this.newFile.set("file",e)},handleChange:function(e,t){this.fileList=t},upload:function(e,t){var a=this,l=e.file.size/1024/1024;if(l>2)this.$message({message:"文件大小必须小于2M",type:"error"}),this.fileList.pop();else{var i=this.newFile;Object(w["i"])(i).then((function(e){var t=e.data;if(t.data&&200===t.status){for(var l=0;l<a.fileList.length;l++)-1===a.fileList[l].name.indexOf("../compose_file/")&&(a.fileList[l].name="../compose_file/"+a.fileList[l].name);a.$message({message:"上传成功",type:"success"})}else a.fileList.pop(),a.$message({message:t.msg,type:"error"})})).catch((function(e){a.fileList.pop(),a.$message({message:"服务器内部错误",type:"error"})}))}}}},S=I,x=(a("153a"),a("2877")),C=Object(x["a"])(S,y,k,!1,null,"6c64923b",null),L=C.exports,V={inject:["reload"],name:"index",components:{MarkdownEditor:_["a"],Compose:L},data:function(){return{markstatus:!1,tableData:[],search:"",localSearch:"",centerDialogVisible:!1,startCon:!1,vulInfo:{rank:"",name:"",vul_name:"",desc:"",degree:[],writeup_date:"",is_flag:!0,HoleType:[],devLanguage:[],devDatabase:[],devClassify:[]},HoleType:[],devLanguage:[],devDatabase:[],devClassify:[],inputVisible1:!1,inputVisible2:!1,inputVisible3:!1,inputVisible4:!1,inputValue1:"",inputValue2:"",inputValue3:"",inputValue4:"",editShow:!1,editLoding:!1,tabLoading:!0,degreeList:[{value:"命令执行",lable:"命令执行"},{value:"代码执行",lable:"代码执行"},{value:"文件写入",lable:"文件写入"},{value:"文件上传",lable:"文件上传"},{value:"后门",lable:"后门"},{value:"默认口令",lable:"默认口令"},{value:"弱口令",lable:"弱口令"},{value:"权限绕过",lable:"权限绕过"},{value:"未授权访问",lable:"未授权访问"},{value:"XXE漏洞",lable:"XXE漏洞"},{value:"SQL注入",lable:"SQL注入"},{value:"文件读取",lable:"文件读取"},{value:"文件下载",lable:"文件下载"},{value:"文件包含",lable:"文件包含"},{value:"文件删除",lable:"文件删除"},{value:"目录遍历",lable:"目录遍历"},{value:"信息泄漏",lable:"信息泄漏"},{value:"任意账户操作",lable:"任意账户操作"},{value:"XSS漏洞",lable:"XSS漏洞"},{value:"SSRF漏洞",lable:"SSRF漏洞"},{value:"CSRF漏洞",lable:"CSRF漏洞"}],languageList:[{value:"Java",lable:"Java"},{value:"Python",lable:"Python"},{value:"C++",lable:"C++"},{value:"C#",lable:"C#"},{value:"VisualBasic",lable:"VisualBasic"},{value:"JavaScript",lable:"JavaScript"},{value:"HTML",lable:"HTML"},{value:"PHP",lable:"PHP"},{value:"R",lable:"R"},{value:"Swift",lable:"Swift"},{value:"Go",lable:"Go"},{value:"Ruby",lable:"Ruby"},{value:"Perl",lable:"Perl"},{value:"Asp",lable:"Asp"},{value:".Net",lable:".Net"}],databaseList:[{value:"Oracle",lable:"Oracle"},{value:"MySQL",lable:"MySQL"},{value:"Microsoft SQL Server",lable:"Microsoft SQL Server"},{value:"PostgreSQL",lable:"PostgreSQL"},{value:"MongoDB",lable:"MongoDB"},{value:"IBM Db2",lable:"IBM Db2"},{value:"Elasticsearch",lable:"Elasticsearch"},{value:"Redis",lable:"Redis"},{value:"SQLite",lable:"SQLite"},{value:"Cassandra",lable:"Cassandra"},{value:"Microsoft Access",lable:"Microsoft Access"},{value:"MariaDB Relational",lable:"MariaDB Relational"},{value:"Splunk",lable:"Splunk"},{value:"Hive",lable:"Hive"},{value:"Teradata",lable:"Teradata"}],classifyList:[{value:"Bootstrap",lable:"Bootstrap"},{value:"Angular",lable:"Angular"},{value:"Jquery",lable:"Jquery"},{value:"react",lable:"react"},{value:"vue",lable:"vue"},{value:"Zepto",lable:"Zepto"},{value:"CakePHP",lable:"CakePHP"},{value:"Django",lable:"Django"},{value:"Ruby on Rails",lable:"Ruby on Rails"},{value:"Flask",lable:"Flask"},{value:"Phoenix",lable:"Phoenix"},{value:"Spring Boot",lable:"Spring Boot"},{value:"Laravel",lable:"Laravel"}],editVulInfo:{rank:"",image_name:"",image_id:"",image_vul_name:"",image_desc:"",degree:[],writeup_date:"",is_flag:!0,is_docker_compose:!1,docker_compose_yml:"",HoleType:[],devLanguage:[],devDatabase:[],devClassify:[]},compose_content:"",imgType:"text",imgTypeText:"切换为文件",loading:!1,summaries:[],taskCheckInterval:null,tmpImageNameList:[],localImageList:[],tmpLocalImageList:[],localLoading:!0,selectLocalImages:[],progressShow:!1,progressLoading:!1,deleteShow:!1,deleteContainerList:[],progress:{title:"",layer:[],total:0,count:0,progress:0,progressInterval:null},taskList:[],taskDict:{},page:{total:0,size:20},value:[],newFile:new FormData,fileList:[],restaurants:[],state:""}},mounted:function(){this.restaurants=this.degreeList},created:function(){this.initTableData(),this.initSummariesList()},methods:{querySearchAsync:function(e,t){var a=this,l=this.summaries;null===e||""===e||0===e.length?(this.initSummariesList(),t(l)):r(e).then((function(e){if(a.summaries=[],200===e.status){var i=e.data["summaries"];null!=i&&i.forEach((function(e,t,l){a.summaries.push({value:e["name"]})})),l=a.summaries,t(l)}}))},handleMark:function(){this.markstatus=!0},closeHandleMark:function(){this.markstatus=!1},getWebsiteData:function(){var e=this;this.loading=!0,Object(s["i"])().then((function(t){var a=t.data;200===a.code?(e.$message({message:"同步完成",type:"success"}),e.reload()):e.$message({message:"同步失败",type:"error"}),e.loading=!1}))},searchSummariesList:function(e){var t=this;this.summaries=[],r(e).then((function(e){if(t.summaries=[],200===e.status){var a=e.data["summaries"];a.forEach((function(e,a,l){t.summaries.push({value:e["name"]})}))}}))},initSummariesList:function(){this.searchSummariesList("")},querySearch:function(e,t,a){var l=a;if(a){if("inputValue1"===l)var i=this.degreeList;if("inputValue2"===l)i=this.languageList;if("inputValue3"===l)i=this.databaseList;if("inputValue4"===l)i=this.classifyList}else i=[];var s=e?i.filter(this.createFilter(e)):i;t(s)},createFilter:function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},handleSel:function(e){},initTableData:function(){var e=this;clearInterval(this.taskCheckInterval),Object(s["f"])(void 0,!0,1).then((function(t){e.tableData=t.data.results,e.tabLoading=!1,e.page.total=t.data.count,e.tableData.forEach((function(t,a,l){var i=t.image_name;e.tmpImageNameList.indexOf(i)>-1&&e.$notify({title:"成功",message:i+" 添加成功",type:"success"})}));var a=t.data.results;e.taskCheckInterval=window.setInterval((function(){setTimeout((function(){e.checkTask(a)}),0)}),2e3)}))},openCreate:function(){this.centerDialogVisible=!0,this.vulInfo.rank=2.5,this.vulInfo.name="",this.vulInfo.vul_name="",this.vulInfo.desc="",this.vulInfo.degree=[],this.vulInfo.writeup_date=[],this.vulInfo.is_flag=!0},openProgress:function(e,t){var a=this;this.progress={title:"",layer:[],total:0,count:0,progress:0,progressInterval:null},this.progressShow=!0,this.progressLoading=!0;var l=e.status.task_id;this.progress.title=1===t?"下载镜像："+e.image_name:"分享镜像："+e.image_name,this.progress.progressInterval=window.setInterval((function(){setTimeout((function(){a.progressLoading=!1,Object(b["c"])(l).then((function(e){null!=e.data.data&&200===e.data.status&&(a.progress.count=e.data.data.progress_count,a.progress.progress=e.data.data.progress,a.progress.total=e.data.data.total,a.progress.layer=e.data.data.layer,(100===a.progress.progress||0!==a.progress.count&&0!==a.progress.total&&a.progress.count===a.progress.total)&&(clearInterval(a.progress.progressInterval),a.progressShow=!1))}))}),1.5)}),2e3)},openEdit:function(e){this.editShow=!0,this.editVulInfo=e,this.compose_content=e.status.json_yml},handleEditImage:function(){var e=this;this.editLoding=!0;var t={HoleType:this.editVulInfo.HoleType,devLanguage:this.editVulInfo.devLanguage,devDatabase:this.editVulInfo.devDatabase,devClassify:this.editVulInfo.devClassify};this.editVulInfo.degree=t,d(this.editVulInfo.image_id,this.editVulInfo).then((function(t){e.editLoding=!1;var a=t.data,l=a.msg;200===a.status?(e.$message({message:"修改成功!",type:"success"}),e.editShow=!1,e.initTableData()):e.$message({message:l,type:"error"})}))},closeDialog:function(){this.editShow=!1,this.editVulInfo=[]},closeProgress:function(){this.progressShow=!1,this.progressLoading=!1;try{clearInterval(this.progress.progressInterval)}catch(e){}},changeType:function(){"file"===this.imgType?(this.imgType="text",this.imgTypeText="切换为文件"):(this.imgType="file",this.imgTypeText="切换为文本")},uploadImg:function(){var e=this,t=new FormData;if(null!=this.$refs.upload){var a=this.$refs.upload.uploadFiles;(null!=this.$refs.upload.uploadFiles||this.$refs.upload.uploadFiles.length>0)&&t.set("file",a[0].raw)}this.vulInfo.HoleType,this.vulInfo.devLanguage,this.vulInfo.devDatabase,this.vulInfo.devClassify;t.set("rank",this.vulInfo.rank),t.set("image_name",this.vulInfo.name),t.set("image_vul_name",this.vulInfo.vul_name),t.set("image_desc",this.vulInfo.desc),t.set("HoleType",this.vulInfo.HoleType),t.set("devLanguage",this.vulInfo.devLanguage),t.set("devDatabase",this.vulInfo.devDatabase),t.set("devClassify",this.vulInfo.devClassify),t.set("is_flag",this.vulInfo.is_flag),t.set("writeup_date",this.vulInfo.writeup_date),this.loading=!0,c(t).then((function(t){e.loading=!1;var a=t.data,l=a["data"];if(null!=l&&(l.indexOf("成功")>-1||l.indexOf("失败")>-1)){var i=l.replace("拉取镜像","").replace("任务下发成功","").replace(" ","");e.tmpImageNameList.push(i),l.indexOf("成功")>-1?(e.$notify({title:"成功",message:l,type:"success"}),e.centerDialogVisible=!1,e.initTableData()):(e.$notify({title:l,message:l,type:"error"}),e.centerDialogVisible=!1)}else e.$notify({title:"成功",message:a["msg"],type:"success"}),e.centerDialogVisible=!1,e.initTableData()}))},downloadImg:function(e){var t=this,a=e.image_id;v(a).then((function(e){var a=e.data,l=a["msg"];if(200===a.status)if(null!=l&&(l.indexOf("成功")>-1||l.indexOf("失败")>-1)){var i=l.replace("拉取镜像","").replace("任务下发成功","").replace(" ","");t.tmpImageNameList.push(i),l.indexOf("成功")>-1?(t.$notify({title:"成功",message:l,type:"success"}),t.initTableData()):t.$notify({message:l,type:"error"})}else t.$notify({message:l,type:"error"});else t.$notify({message:l,type:"error"}),t.centerDialogVisible=!1}))},shareImg:function(e){var t=this;e.status.status="share",g(e.image_id).then((function(e){var a=e.data,l=a.status;200===l||t.$message({message:a.msg,type:"error"}),t.initTableData()}))},handleDelete:function(e){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){p(e.image_id).then((function(e){var a=e.data;200===a.status?(t.$message({title:"成功",message:"删除成功!",type:"success"}),t.initTableData()):(t.deleteShow=!0,t.deleteContainerList=a.data,t.$message({title:"失败",message:a.msg,type:"error"}))}))})).catch((function(){}))},handleQuery:function(e){var t=this;Object(s["f"])(this.search,!0,e).then((function(e){t.tableData=e.data.results,t.page.total=e.data.count}))},handleSelect:function(e){this.vulInfo.name=e.value,this.vulInfo.vul_name=e.value.replace("vulfocus/",""),this.vulInfo.desc=e.value.replace("vulfocus/","")},checkTask:function(e){var t=this;e.forEach((function(e,a,l){var i=e["is_ok"],s=e["status"]["task_id"],n=e["status"]["progress_status"];(!1===i&&null!=s&&""!==s||!0===i&&null!=s&&""!==s&&"share"===n)&&-1===t.taskList.indexOf(s)&&(t.taskList.push(s),t.taskDict[s]=e)}));var a=this.taskList.join(",");if(null!=a&&""!==a){var l=new FormData;l.set("task_ids",a),Object(b["a"])(l).then((function(e){var a=e.data.data;for(var l in a){var i=a[l],s=i["status"];if(1!==s&&2!==s)if(t.removeArray(t.taskList,l),t.taskDict[l].is_ok=!0,200===i["data"]["status"]){var n=i["data"]["data"];try{var o=n.replace('{"image_port":',"").replace("}","").replace(":","").replace('"',"").replace('"',"");t.taskDict[l].image_port=o}catch(r){}try{i["data"]["msg"].indexOf("分享")>-1&&(t.taskDict[l].is_share=!0,t.taskDict[l].status.progress_status="")}catch(r){}t.$notify({message:i["data"]["msg"],type:"success"})}else{try{i["data"]["msg"].indexOf("分享")>-1&&(t.taskDict[l].is_share=!1,t.taskDict[l].status.progress_status="")}catch(r){}t.$notify({message:i["data"]["msg"],type:"error"})}else t.taskDict[l].status.progress=i["progress"]}null!=t.taskList&&0!==t.taskList.length||(t.taskList=[],t.taskDict={},clearInterval(t.taskCheckInterval))}))}},removeArray:function(e,t){for(var a=0;a<e.length;a++)if(e[a]===t){e.splice(a,1);break}},loadLocalImages:function(){var e=this;this.localLoading=!0,f().then((function(t){var a=t.data,l=a.status,i=a.data;200===l&&(e.localImageList=i,e.tmpLocalImageList=i),e.localLoading=!1}))},handleClick:function(e,t){var a=e.name;"local"===a&&this.loadLocalImages()},handleLocalRemove:function(e){for(var t=0;t<this.localImageList.length;t++)if(this.localImageList[t].name===e){this.localImageList.splice(t,1);break}},handleSelectLocalImages:function(e){var t=[];for(var a in e)t.push(e[a].name);this.selectLocalImages=t},batchLocalAdd:function(){var e=this;if(0!==this.selectLocalImages.length){var t=new FormData;t.set("image_names",this.selectLocalImages.join(",")),m(t).then((function(t){var a=t.data,l=a.data,i=a.status;if(200===i){for(var s=0;s<l.length;s++){var n=l[s],o=n.replace(" ","").replace("拉取镜像","").replace("任务下发成功","");e.tmpImageNameList.push(o),e.$notify({title:"成功",message:n,type:"success"})}e.centerDialogVisible=!1,e.initTableData()}else 201===i?e.$notify({title:"失败",message:a["msg"],type:"info"}):e.$notify({title:"失败",message:a["msg"],type:"error"})}))}},delContainer:function(e){var t=this;Object(h["a"])(e.container_id).then((function(a){var l=a.data["data"],i=window.setInterval((function(){setTimeout((function(){Object(b["b"])(l).then((function(a){var l=a.data["status"],s=a.data;1001===l||(clearInterval(i),200===l?(t.$message({type:"success",message:"删除成功"}),p(e.image_id).then((function(e){var a=e.data;200!==a.status?t.deleteContainerList=a.data:(t.$message({type:"success",message:"删除成功"}),t.deleteShow=!1,t.initTableData())}))):t.$message({message:s["msg"],type:"error"}))}))}),1)}),1e3)}))},upload:function(e,t){var a=this,l=e.file.size/1024/1024;if(l>2)this.$message({message:"文件大小必须小于2M",type:"error"}),this.fileList.pop();else{var i=this.newFile;Object(w["i"])(i).then((function(e){var t=e.data;if(t.data&&200===t.status){for(var l=0;l<a.fileList.length;l++)-1===a.fileList[l].name.indexOf("../compose_file/")&&(a.fileList[l].name="../compose_file/"+a.fileList[l].name);a.$message({message:"上传成功",type:"success"})}else a.fileList.pop(),a.$message({message:t.msg,type:"error"})})).catch((function(e){a.fileList.pop(),a.$message({message:"服务器内部错误",type:"error"})}))}},removeChange:function(e,t){var a=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var l=new FormData;l.set("file",e.name),Object(w["b"])(l).then((function(l){var i=l.data;if(200===i.status){for(var s=0;s<t.length;s++)t[s]===e&&t.splice(s,1);a.$message({type:"success",message:"删除成功!"})}else t.push(e),a.$message({type:"error",message:"删除失败!"})}))})).catch((function(){t.push(e),a.$message({type:"info",message:"已取消删除"})}))},update_compose_build:function(){var e=this,t={};t.compose_content=this.compose_content,t.image_id=this.editVulInfo.image_id,Object(w["h"])(t).then((function(t){200===t.data.code?(e.$message({title:"构建任务创建成功",message:t.data.message,type:"success"}),e.editShow=!1,e.initTableData()):e.$message({title:"构建任务创建失败",message:t.data.message,type:"error"})}))},beforeAvatarUpload:function(e){if(!e)return!1;this.newFile.set("file",e)},handleChange:function(e,t){this.fileList=t},handleClose:function(e,t,a){var l=t;"newtag"===a?("HoleType"===l&&this.vulInfo.HoleType.splice(this.vulInfo.HoleType.indexOf(e),1),"devLanguage"===l&&this.vulInfo.devLanguage.splice(this.vulInfo.devLanguage.indexOf(e),1),"devDatabase"===l&&this.vulInfo.devDatabase.splice(this.vulInfo.devDatabase.indexOf(e),1),"devClassify"===l&&this.vulInfo.devClassify.splice(this.vulInfo.devClassify.indexOf(e),1)):("HoleType"===l&&this.editVulInfo.HoleType.splice(this.editVulInfo.HoleType.indexOf(e),1),"devLanguage"===l&&this.editVulInfo.devLanguage.splice(this.editVulInfo.devLanguage.indexOf(e),1),"devDatabase"===l&&this.editVulInfo.devDatabase.splice(this.editVulInfo.devDatabase.indexOf(e),1),"devClassify"===l&&this.editVulInfo.devClassify.splice(this.editVulInfo.devClassify.indexOf(e),1))},showInput1:function(){var e=this;this.inputVisible1=!0,this.$nextTick((function(t){e.$refs.saveTagInput1.$refs.input.focus()}))},showInput2:function(){var e=this;this.inputVisible2=!0,this.$nextTick((function(t){e.$refs.saveTagInput2.$refs.input.focus()}))},showInput3:function(){var e=this;this.inputVisible3=!0,this.$nextTick((function(t){e.$refs.saveTagInput3.$refs.input.focus()}))},showInput4:function(){var e=this;this.inputVisible4=!0,this.$nextTick((function(t){e.$refs.saveTagInput4.$refs.input.focus()}))},handleInputConfirm1:function(e){var t=this.inputValue1;"newtag"===e?this.vulInfo.HoleType.push(t):this.editVulInfo.HoleType.push(t),this.inputVisible1=!1,this.inputValue1=""},handleInputConfirm2:function(e){var t=this.inputValue2;"newtag"===e?this.vulInfo.devLanguage.push(t):this.editVulInfo.devLanguage.push(t),this.inputVisible2=!1,this.inputValue2=""},handleInputConfirm3:function(e){var t=this.inputValue3;"newtag"===e?this.vulInfo.devDatabase.push(t):this.editVulInfo.devDatabase.push(t),this.inputVisible3=!1,this.inputValue3=""},handleInputConfirm4:function(e){var t=this.inputValue4;"newtag"===e?this.vulInfo.devClassify.push(t):this.editVulInfo.devClassify.push(t),this.inputVisible4=!1,this.inputValue4=""}}},T=V,D=(a("5969"),Object(x["a"])(T,l,i,!1,null,"1aca16df",null));t["default"]=D.exports},ea7f:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return n}));var l=a("b775");function i(e){return Object(l["a"])({url:"/tasks/"+e+"/get/",method:"get"})}function s(e){return Object(l["a"])({url:"/tasks/batch/batch/",method:"post",data:e})}function n(e){return Object(l["a"])({url:"/tasks/"+e+"/progress/",method:"get"})}}}]);
//# sourceMappingURL=chunk-f241b7b6.363cf4e6.js.map