(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50de06a8"],{"02f4":function(e,t,a){var i=a("4588"),l=a("be13");e.exports=function(e){return function(t,a){var n,s,r=String(l(t)),o=i(a),c=r.length;return o<0||o>=c?e?"":void 0:(n=r.charCodeAt(o),n<55296||n>56319||o+1===c||(s=r.charCodeAt(o+1))<56320||s>57343?e?r.charAt(o):n:e?r.slice(o,o+2):s-56320+(n-55296<<10)+65536)}}},"0390":function(e,t,a){"use strict";var i=a("02f4")(!0);e.exports=function(e,t,a){return t+(a?i(e,t).length:1)}},"16d8":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:e.id}})},l=[],n=a("db72"),s=(a("a7be"),a("44f8"),a("a6e0"),a("2c43"),a("bff0"),a("1487"),a("547e")),r=a.n(s),o={minHeight:"500px",previewStyle:"vertical",useCommandShortcut:!0,useDefaultHTMLSanitizer:!0,usageStatistics:!1,hideModeSwitch:!1,viewer:!0,toolbarItems:["heading","bold","italic","strike","divider","hr","quote","divider","ul","ol","task","indent","outdent","divider","table","image","link","divider","code","codeblock"]},c={name:"MarkdownEditor",props:{value:{type:String,default:""},id:{type:String,required:!1,default:function(){return"markdown-editor-"+ +new Date+(1e3*Math.random()).toFixed(0)}},options:{type:Object,default:function(){return o}},mode:{type:String,default:"markdown"},height:{type:String,required:!1,default:"300px"},language:{type:String,required:!1,default:"en_US"}},data:function(){return{editor:null}},computed:{editorOptions:function(){var e=Object.assign({},o,this.options);return e.initialEditType=this.mode,e.height=this.height,e.language=this.language,e}},watch:{value:function(e,t){e!==t&&e!==this.editor.getValue()&&this.editor.setValue(e)},language:function(e){this.destroyEditor(),this.initEditor()},height:function(e){this.editor.height(e)},mode:function(e){this.editor.changeMode(e)}},mounted:function(){this.initEditor()},destroyed:function(){this.destroyEditor()},methods:{initEditor:function(){var e=this;this.editor=new r.a(Object(n["a"])({el:document.getElementById(this.id)},this.editorOptions)),this.value&&this.editor.setValue(this.value),this.editor.on("change",(function(){e.$emit("input",e.editor.getValue())}))},destroyEditor:function(){this.editor&&(this.editor.off("change"),this.editor.remove())},setValue:function(e){this.editor.setValue(e)},getValue:function(){return this.editor.getValue()},setHtml:function(e){this.editor.setHtml(e)},getHtml:function(){return this.editor.getHtml()}}},u=c,d=a("2877"),m=Object(d["a"])(u,i,l,!1,null,null,null);t["a"]=m.exports},"4dd0":function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return n})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return r}));var i=a("b775");function l(e,t,a){return void 0!==t&&null!==t||(t=1),void 0!==a&&null!=a||(a=""),Object(i["a"])({url:"/container/?flag="+e+"&page="+t+"&image_id="+a,method:"get"})}function n(e){return Object(i["a"])({url:"/container/"+e+"/stop/?flag=list",method:"get"})}function s(e){return Object(i["a"])({url:"/container/"+e+"/start/?flag=list",method:"get"})}function r(e){return Object(i["a"])({url:"/container/"+e+"/delete/?flag=list",method:"delete"})}},a481:function(e,t,a){"use strict";var i=a("cb7c"),l=a("4bf8"),n=a("9def"),s=a("4588"),r=a("0390"),o=a("5f1b"),c=Math.max,u=Math.min,d=Math.floor,m=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g,p=function(e){return void 0===e?e:String(e)};a("214f")("replace",2,(function(e,t,a,g){return[function(i,l){var n=e(this),s=void 0==i?void 0:i[t];return void 0!==s?s.call(i,n,l):a.call(String(n),i,l)},function(e,t){var l=g(a,e,this,t);if(l.done)return l.value;var d=i(e),m=String(this),f="function"===typeof t;f||(t=String(t));var h=d.global;if(h){var b=d.unicode;d.lastIndex=0}var _=[];while(1){var y=o(d,m);if(null===y)break;if(_.push(y),!h)break;var k=String(y[0]);""===k&&(d.lastIndex=r(m,n(d.lastIndex),b))}for(var w="",I=0,S=0;S<_.length;S++){y=_[S];for(var x=String(y[0]),L=c(u(s(y.index),m.length),0),$=[],D=1;D<y.length;D++)$.push(p(y[D]));var V=y.groups;if(f){var T=[x].concat($,L,m);void 0!==V&&T.push(V);var C=String(t.apply(void 0,T))}else C=v(x,m,L,$,V,t);L>=I&&(w+=m.slice(I,L)+C,I=L+x.length)}return w+m.slice(I)}];function v(e,t,i,n,s,r){var o=i+e.length,c=n.length,u=f;return void 0!==s&&(s=l(s),u=m),a.call(r,u,(function(a,l){var r;switch(l.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,i);case"'":return t.slice(o);case"<":r=s[l.slice(1,-1)];break;default:var u=+l;if(0===u)return a;if(u>c){var m=d(u/10);return 0===m?a:m<=c?void 0===n[m-1]?l.charAt(1):n[m-1]+l.charAt(1):a}r=n[u-1]}return void 0===r?"":r}))}}))},e036:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-dialog",{attrs:{visible:e.centerDialogVisible,title:"添加",width:"60%"},on:{"update:visible":function(t){e.centerDialogVisible=t}}},[a("el-tabs",{attrs:{value:"add"},on:{"tab-click":e.handleClick}},[a("el-tab-pane",{attrs:{name:"add",label:"添加"}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"label-width":"80px","element-loading-text":"添加中"}},[a("el-form-item",{attrs:{label:"漏洞名称"}},[a("el-input",{attrs:{size:"medium"},model:{value:e.vulInfo.vul_name,callback:function(t){e.$set(e.vulInfo,"vul_name",t)},expression:"vulInfo.vul_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"镜像"}},[a("el-col",{attrs:{span:17}},["file"===e.imgType?a("el-upload",{ref:"upload",attrs:{"http-request":e.uploadImg,accept:".tar",action:"/CombinationImage/",limit:1,"auto-upload":!1}},[a("el-button",{attrs:{slot:"trigger",size:"medium",type:"primary"},slot:"trigger"},[e._v("选取文件")])],1):e._e(),e._v(" "),"text"===e.imgType?a("el-autocomplete",{staticStyle:{width:"100%"},attrs:{size:"medium","fetch-suggestions":e.querySearchAsync},on:{select:e.handleSelect},model:{value:e.vulInfo.name,callback:function(t){e.$set(e.vulInfo,"name",t)},expression:"vulInfo.name"}}):e._e()],1),e._v(" "),a("el-col",{staticStyle:{float:"right",right:"0"},attrs:{span:5}},[a("el-button",{attrs:{size:"medium"},on:{click:function(t){return t.stopPropagation(),e.changeType(t)}},model:{value:e.imgType,callback:function(t){e.imgType=t},expression:"imgType"}},[e._v(e._s(e.imgTypeText))])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"分类"}},[a("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择镜像标签"},model:{value:e.vulInfo.degree,callback:function(t){e.$set(e.vulInfo,"degree",t)},expression:"vulInfo.degree"}},e._l(e.degreeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Rank"}},[a("el-input-number",{attrs:{min:.5,max:5,precision:1,step:.5,size:"medium"},model:{value:e.vulInfo.rank,callback:function(t){e.$set(e.vulInfo,"rank",t)},expression:"vulInfo.rank"}}),e._v(" "),a("el-tooltip",{attrs:{content:"默认分数为2.5分，可根据漏洞的利用难度进行评判",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea",size:"medium"},model:{value:e.vulInfo.desc,callback:function(t){e.$set(e.vulInfo,"desc",t)},expression:"vulInfo.desc"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"flag"}},[a("el-switch",{model:{value:e.vulInfo.is_flag,callback:function(t){e.$set(e.vulInfo,"is_flag",t)},expression:"vulInfo.is_flag"}}),e._v(" "),a("el-tooltip",{attrs:{content:"是否开启flag",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.uploadImg}},[e._v("提 交")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.handleMark}},[e._v("编辑writeup")])],1),e._v(" "),!0===e.markstatus?a("el-form-item",[a("div",{staticClass:"container"},[a("markdown-editor",{ref:"markdownEditor",attrs:{options:{hideModeSwitch:!0,previewStyle:"tab"},height:"200px"},model:{value:e.vulInfo.writeup_date,callback:function(t){e.$set(e.vulInfo,"writeup_date",t)},expression:"vulInfo.writeup_date"}})],1),e._v(" "),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.closeHandleMark}},[e._v("关闭")])],1):e._e()],1)],1),e._v(" "),a("el-tab-pane",{attrs:{name:"local",label:"本地导入"}},[a("div",{staticClass:"filter-container"},[a("el-input",{staticStyle:{width:"230px"},attrs:{size:"medium"},model:{value:e.localSearch,callback:function(t){e.localSearch=t},expression:"localSearch"}}),e._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px","margin-bottom":"10px"},attrs:{size:"medium",type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.batchLocalAdd}},[e._v("\n                一键导入\n              ")]),e._v("   \n              "),a("el-tooltip",{attrs:{content:"一键导入默认导入分数为 2.5 分,漏洞名称为镜像名称,漏洞描述为漏洞名称",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.localLoading,expression:"localLoading"}],staticStyle:{width:"100%"},attrs:{data:e.localImageList.filter((function(t){return!e.localSearch||t.name.toLowerCase().includes(e.localSearch.toLowerCase())})),"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectLocalImages}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"标签",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[!0===i.flag?a("el-tag",{attrs:{effect:"dark",type:"info"}},[e._v("已导入")]):!1===i.flag?a("el-tag",{attrs:{effect:"dark"}},[e._v("未导入")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-button",{attrs:{type:"danger",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLocalRemove(i.name)}}},[e._v("移除")])]}}])})],1)],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.progressShow,title:e.progress.title,width:"60%","before-close":e.closeProgress},on:{"update:visible":function(t){e.progressShow=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.progressLoading,expression:"progressLoading"}]},e._l(e.progress.layer,(function(t,i){return a("el-row",{staticStyle:{"margin-bottom":"10px",height:"24px"}},[a("el-tag",{staticStyle:{float:"left",width:"15%",height:"24px","line-height":"24px"},attrs:{align:"center"}},[e._v(e._s(t.id))]),e._v(" "),a("div",{staticStyle:{float:"left",width:"80%","margin-left":"10px"}},[100===t.progress?a("el-progress",{attrs:{percentage:t.progress,"text-inside":!0,"stroke-width":24,status:"success"}}):a("el-progress",{attrs:{percentage:t.progress,"text-inside":!0,"stroke-width":24}})],1)],1)})),1)]),e._v(" "),a("el-dialog",{attrs:{visible:e.deleteShow,title:"删除",width:"80%"},on:{"update:visible":function(t){e.deleteShow=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.deleteContainerList,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"vul_name",width:"150","show-overflow-tooltip":!0,label:"漏洞名称"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"user_name",width:"100",label:"用户名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"vul_host",width:"200","show-overflow-tooltip":!0,label:"访问地址"}}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"85"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("el-tag",[e._v(e._s(i.container_status))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"vul_desc","show-overflow-tooltip":!0,width:"300",label:"漏洞描述"}}),e._v(" "),a("el-table-column",{attrs:{prop:"combination_desc",label:"操作","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return["running"===i.container_status||"stop"===i.container_status?a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.delContainer(i)}}},[e._v("删除")]):e._e()]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.editShow,title:"修改"},on:{"update:visible":function(t){e.editShow=t}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.editLoding,expression:"editLoding"}],attrs:{"label-width":"80px","element-loading-text":"修改中"}},[a("el-form-item",{attrs:{label:"漏洞名称"}},[a("el-input",{attrs:{size:"medium"},model:{value:e.editVulInfo.image_vul_name,callback:function(t){e.$set(e.editVulInfo,"image_vul_name",t)},expression:"editVulInfo.image_vul_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"镜像"}},[a("el-input",{attrs:{disabled:""},model:{value:e.editVulInfo.image_name,callback:function(t){e.$set(e.editVulInfo,"image_name",t)},expression:"editVulInfo.image_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"分类"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择镜像标签"},model:{value:e.editVulInfo.degree,callback:function(t){e.$set(e.editVulInfo,"degree",t)},expression:"editVulInfo.degree"}},e._l(e.degreeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"Rank"}},[a("el-input-number",{attrs:{min:.5,max:5,precision:1,step:.5,size:"medium"},model:{value:e.editVulInfo.rank,callback:function(t){e.$set(e.editVulInfo,"rank",t)},expression:"editVulInfo.rank"}}),e._v(" "),a("el-tooltip",{attrs:{content:"默认分数为2.5分，可根据漏洞的利用难度进行评判",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"flag"}},[a("el-switch",{model:{value:e.editVulInfo.is_flag,callback:function(t){e.$set(e.editVulInfo,"is_flag",t)},expression:"editVulInfo.is_flag"}}),e._v(" "),a("el-tooltip",{attrs:{content:"是否开启flag",placement:"top"}},[a("i",{staticClass:"el-icon-question"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea",size:"medium"},model:{value:e.editVulInfo.image_desc,callback:function(t){e.$set(e.editVulInfo,"image_desc",t)},expression:"editVulInfo.image_desc"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.handleEditImage}},[e._v("提 交")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.handleMark}},[e._v("修改writeup")])],1),e._v(" "),!0===e.markstatus?a("el-form-item",[a("div",{staticClass:"container"},[a("markdown-editor",{ref:"markdownEditor",attrs:{options:{hideModeSwitch:!0,previewStyle:"tab"},height:"200px"},model:{value:e.editVulInfo.writeup_date,callback:function(t){e.$set(e.editVulInfo,"writeup_date",t)},expression:"editVulInfo.writeup_date"}})],1),e._v(" "),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.closeHandleMark}},[e._v("关闭")])],1):e._e()],1)],1),e._v(" "),a("div",{staticClass:"filter-container"},[a("el-input",{staticStyle:{width:"230px"},attrs:{size:"medium"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px","margin-bottom":"10px"},attrs:{size:"medium",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.handleQuery(1)}}},[e._v("\n        查询\n      ")]),e._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px","margin-bottom":"10px"},attrs:{size:"medium",type:"primary",icon:"el-icon-edit"},on:{click:e.openCreate}},[e._v("\n        添加\n      ")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tabLoading,expression:"tabLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:"",align:"center"}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"image_name",label:"镜像名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"image_vul_name",label:"漏洞名称","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"image_port",label:"端口",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"rank",label:"分数",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{label:"漏洞分类",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return i.degree.length>0&&""!==i.degree?e._l(i.degree,(function(t){return a("el-tag",{staticStyle:{"margin-left":"2px"}},[e._v(e._s(t))])})):void 0}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{prop:"image_desc","show-overflow-tooltip":!0,label:"描述"}}),e._v(" "),a("el-table-column",{attrs:{prop:"update_date","show-overflow-tooltip":!0,label:"修改时间"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[!1===i.is_ok&&""!==i.status.task_id?a("el-tag",{staticStyle:{display:"inline-block",float:"left","line-height":"28px",height:"28px","margin-left":"5px"},attrs:{effect:"dark"},on:{click:function(t){return e.openProgress(i,1)}}},[a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("span",[e._v("下载中")])]),e._v(" "),a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("el-progress",{staticStyle:{"margin-left":"3px","margin-top":"3px"},attrs:{type:"circle","stroke-width":3,"show-text":!1,"text-inside":!1,percentage:i.status.progress,width:20}})],1)]):!1===i.is_ok&&""===i.status.task_id?a("el-button",{staticStyle:{display:"inline-block",float:"left","margin-left":"5px"},attrs:{size:"mini",type:"primary",icon:"el-icon-download"},on:{click:function(t){return e.downloadImg(i)}}},[e._v("下载")]):e._e(),e._v(" "),!0===i.is_ok||!1===i.is_ok&&""===i.status.task_id?a("el-button",{staticStyle:{display:"inline-block",float:"left","margin-left":"5px"},attrs:{size:"mini",icon:"el-icon-edit",type:"primary"},on:{click:function(t){return e.openEdit(i)}}},[e._v("修改")]):e._e(),e._v(" "),!0===i.is_ok||!1===i.is_ok&&""===i.status.task_id?a("el-button",{staticStyle:{display:"inline-block",float:"left","margin-left":"5px"},attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.handleDelete(i)}}},[e._v("删除")]):e._e(),e._v(" "),!0===i.is_ok&&!0===i.is_share?a("el-tag",{staticStyle:{display:"inline-block",float:"left","line-height":"28px",height:"28px","margin-left":"5px"},attrs:{type:"success",effect:"dark"}},[a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("span",[e._v("已分享")])])]):e._e(),e._v(" "),!0===i.is_ok&&!1===i.is_share&&"share"!==i.status.progress_status?a("el-button",{staticStyle:{display:"inline-block",float:"left","margin-left":"5px"},attrs:{size:"mini",type:"primary",icon:"el-icon-share"},on:{click:function(t){return e.shareImg(i)}}},[e._v("分享")]):e._e(),e._v(" "),!0===i.is_ok&&"share"===i.status.progress_status?a("el-tag",{staticStyle:{display:"inline-block",float:"left","line-height":"28px",height:"28px","margin-left":"5px"},attrs:{effect:"dark"},on:{click:function(t){return e.openProgress(i,2)}}},[a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("span",[e._v("分享中")])]),e._v(" "),a("div",{staticStyle:{display:"inline-block",float:"left"}},[a("el-progress",{staticStyle:{"margin-left":"3px","margin-top":"3px"},attrs:{type:"circle","stroke-width":3,"show-text":!1,"text-inside":!1,percentage:i.status.progress,width:20}})],1)]):e._e()]}}])})],1),e._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-pagination",{attrs:{"page-size":e.page.size,layout:"total, prev, pager, next, jumper",total:e.page.total},on:{"current-change":e.handleQuery}})],1)],1)},l=[],n=(a("386d"),a("a481"),a("7f7f"),a("ac6a"),a("3007")),s=a("bc3a"),r=a.n(s);function o(e){var t="https://hub.docker.com/api/content/v1/products/search?page_size=50&q=vulfocus%2F"+e+"&type=image";return r()({method:"get",url:t,headers:{"Sec-Fetch-Site":"none","Sec-Fetch-Mode":"cors","Sec-Fetch-Dest":"empty","Accept-Encoding":"gzip, deflate","Accept-Language":"zh-CN,zh;q=0.9","Search-Version":"v3"}})}var c=a("b775");function u(e){return Object(c["a"])({url:"/images/",method:"post",headers:{"Content-Type":"multipart/form-data"},data:e})}function d(e,t){return Object(c["a"])({url:"/images/"+e+"/edit/",method:"post",data:t})}function m(e){return Object(c["a"])({url:"/images/"+e+"/delete/"})}function f(){return Object(c["a"])({url:"/images/local/local/"})}function p(e){return Object(c["a"])({url:"/images/local/local_add/",method:"post",data:e})}function g(e){return Object(c["a"])({url:"/images/"+e+"/download/"})}function v(e){return Object(c["a"])({url:"/images/"+e+"/share/"})}var h=a("4dd0"),b=a("ea7f"),_=a("16d8"),y={name:"index",components:{MarkdownEditor:_["a"]},data:function(){return{markstatus:!1,tableData:[],search:"",localSearch:"",centerDialogVisible:!1,startCon:!1,vulInfo:{rank:"",name:"",vul_name:"",desc:"",degree:[],writeup_date:"",is_flag:!0},editShow:!1,editLoding:!1,tabLoading:!0,degreeList:[{value:"命令执行",lable:"命令执行"},{value:"代码执行",lable:"代码执行"},{value:"文件写入",lable:"文件写入"},{value:"文件上传",lable:"文件上传"},{value:"后门",lable:"后门"},{value:"默认口令",lable:"默认口令"},{value:"弱口令",lable:"弱口令"},{value:"权限绕过",lable:"权限绕过"},{value:"未授权访问",lable:"未授权访问"},{value:"XXE漏洞",lable:"XXE漏洞"},{value:"SQL注入",lable:"SQL注入"},{value:"文件读取",lable:"文件读取"},{value:"文件下载",lable:"文件下载"},{value:"文件包含",lable:"文件包含"},{value:"文件删除",lable:"文件删除"},{value:"目录遍历",lable:"目录遍历"},{value:"信息泄漏",lable:"信息泄漏"},{value:"任意账户操作",lable:"任意账户操作"},{value:"XSS漏洞",lable:"XSS漏洞"},{value:"SSRF漏洞",lable:"SSRF漏洞"},{value:"CSRF漏洞",lable:"CSRF漏洞"}],editVulInfo:{rank:"",image_name:"",image_id:"",image_vul_name:"",image_desc:"",degree:[],writeup_date:"",is_flag:!0},imgType:"text",imgTypeText:"切换为文件",loading:!1,summaries:[],taskCheckInterval:null,tmpImageNameList:[],localImageList:[],tmpLocalImageList:[],localLoading:!0,selectLocalImages:[],progressShow:!1,progressLoading:!1,deleteShow:!1,deleteContainerList:[],progress:{title:"",layer:[],total:0,count:0,progress:0,progressInterval:null},taskList:[],taskDict:{},page:{total:0,size:20},value:[]}},created:function(){this.initTableData(),this.initSummariesList()},methods:{querySearchAsync:function(e,t){var a=this,i=this.summaries;null===e||""===e||0===e.length?(this.initSummariesList(),t(i)):o(e).then((function(e){if(a.summaries=[],200===e.status){var l=e.data["summaries"];null!=l&&l.forEach((function(e,t,i){a.summaries.push({value:e["name"]})})),i=a.summaries,t(i)}}))},handleMark:function(){this.markstatus=!0},closeHandleMark:function(){this.markstatus=!1},searchSummariesList:function(e){var t=this;this.summaries=[],o(e).then((function(e){if(t.summaries=[],200===e.status){var a=e.data["summaries"];a.forEach((function(e,a,i){t.summaries.push({value:e["name"]})}))}}))},initSummariesList:function(){this.searchSummariesList("")},initTableData:function(){var e=this;clearInterval(this.taskCheckInterval),Object(n["e"])(void 0,!0,1).then((function(t){e.tableData=t.data.results,e.tabLoading=!1,e.page.total=t.data.count,e.tableData.forEach((function(t,a,i){var l=t.image_name;e.tmpImageNameList.indexOf(l)>-1&&e.$notify({title:"成功",message:l+" 添加成功",type:"success"})}));var a=t.data.results;e.taskCheckInterval=window.setInterval((function(){setTimeout((function(){e.checkTask(a)}),0)}),2e3)}))},openCreate:function(){this.centerDialogVisible=!0,this.vulInfo.rank=2.5,this.vulInfo.name="",this.vulInfo.vul_name="",this.vulInfo.desc="",this.vulInfo.degree=[],this.vulInfo.writeup_date=[],this.vulInfo.is_flag=!0},openProgress:function(e,t){var a=this;this.progress={title:"",layer:[],total:0,count:0,progress:0,progressInterval:null},this.progressShow=!0,this.progressLoading=!0;var i=e.status.task_id;this.progress.title=1===t?"下载镜像："+e.image_name:"分享镜像："+e.image_name,this.progress.progressInterval=window.setInterval((function(){setTimeout((function(){a.progressLoading=!1,Object(b["c"])(i).then((function(e){null!=e.data.data&&200===e.data.status&&(a.progress.count=e.data.data.progress_count,a.progress.progress=e.data.data.progress,a.progress.total=e.data.data.total,a.progress.layer=e.data.data.layer,(100===a.progress.progress||0!==a.progress.count&&0!==a.progress.total&&a.progress.count===a.progress.total)&&(clearInterval(a.progress.progressInterval),a.progressShow=!1))}))}),1.5)}),2e3)},openEdit:function(e){this.editShow=!0,this.editVulInfo=e},handleEditImage:function(){var e=this;this.editLoding=!0,d(this.editVulInfo.image_id,this.editVulInfo).then((function(t){e.editLoding=!1;var a=t.data,i=a.msg;200===a.status?(e.$message({message:"修改成功!",type:"success"}),e.editShow=!1,e.initTableData()):e.$message({message:i,type:"error"})}))},closeProgress:function(){this.progressShow=!1,this.progressLoading=!1;try{clearInterval(this.progress.progressInterval)}catch(e){}},changeType:function(){"file"===this.imgType?(this.imgType="text",this.imgTypeText="切换为文件"):(this.imgType="file",this.imgTypeText="切换为文本")},uploadImg:function(){var e=this,t=new FormData;if(null!=this.$refs.upload){var a=this.$refs.upload.uploadFiles;(null!=this.$refs.upload.uploadFiles||this.$refs.upload.uploadFiles.length>0)&&t.set("file",a[0].raw)}t.set("rank",this.vulInfo.rank),t.set("image_name",this.vulInfo.name),t.set("image_vul_name",this.vulInfo.vul_name),t.set("image_desc",this.vulInfo.desc),t.set("degree",this.vulInfo.degree),t.set("is_flag",this.vulInfo.is_flag),t.set("writeup_date",this.vulInfo.writeup_date),this.loading=!0,u(t).then((function(t){e.loading=!1;var a=t.data,i=a["data"];if(null!=i&&(i.indexOf("成功")>-1||i.indexOf("失败")>-1)){var l=i.replace("拉取镜像","").replace("任务下发成功","").replace(" ","");e.tmpImageNameList.push(l),i.indexOf("成功")>-1?(e.$notify({title:"成功",message:i,type:"success"}),e.centerDialogVisible=!1,e.initTableData()):(e.$notify({title:i,message:i,type:"error"}),e.centerDialogVisible=!1)}else e.$notify({title:"成功",message:a["msg"],type:"success"}),e.centerDialogVisible=!1,e.initTableData()}))},downloadImg:function(e){var t=this,a=e.image_id;g(a).then((function(e){var a=e.data,i=a["msg"];if(200===a.status)if(null!=i&&(i.indexOf("成功")>-1||i.indexOf("失败")>-1)){var l=i.replace("拉取镜像","").replace("任务下发成功","").replace(" ","");t.tmpImageNameList.push(l),i.indexOf("成功")>-1?(t.$notify({title:"成功",message:i,type:"success"}),t.initTableData()):t.$notify({message:i,type:"error"})}else t.$notify({message:i,type:"error"});else t.$notify({message:i,type:"error"}),t.centerDialogVisible=!1}))},shareImg:function(e){var t=this;e.status.status="share",v(e.image_id).then((function(e){var a=e.data,i=a.status;200===i||t.$message({message:a.msg,type:"error"}),t.initTableData()}))},handleDelete:function(e){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){m(e.image_id).then((function(e){var a=e.data;200===a.status?(t.$message({title:"成功",message:"删除成功!",type:"success"}),t.initTableData()):(t.deleteShow=!0,t.deleteContainerList=a.data,t.$message({title:"失败",message:a.msg,type:"error"}))}))})).catch((function(){}))},handleQuery:function(e){var t=this;Object(n["e"])(this.search,!0,e).then((function(e){t.tableData=e.data.results,t.page.total=e.data.count}))},handleSelect:function(e){this.vulInfo.name=e.value,this.vulInfo.vul_name=e.value.replace("vulfocus/",""),this.vulInfo.desc=e.value.replace("vulfocus/","")},checkTask:function(e){var t=this;e.forEach((function(e,a,i){var l=e["is_ok"],n=e["status"]["task_id"],s=e["status"]["progress_status"];(!1===l&&null!=n&&""!==n||!0===l&&null!=n&&""!==n&&"share"===s)&&-1===t.taskList.indexOf(n)&&(t.taskList.push(n),t.taskDict[n]=e)}));var a=this.taskList.join(",");if(null!=a&&""!==a){var i=new FormData;i.set("task_ids",a),Object(b["a"])(i).then((function(e){var a=e.data.data;for(var i in a){var l=a[i],n=l["status"];if(1!==n)if(t.removeArray(t.taskList,i),t.taskDict[i].is_ok=!0,200===l["data"]["status"]){var s=l["data"]["data"];try{var r=s.replace('{"image_port":',"").replace("}","").replace(":","").replace('"',"").replace('"',"");t.taskDict[i].image_port=r}catch(o){}try{l["data"]["msg"].indexOf("分享")>-1&&(t.taskDict[i].is_share=!0,t.taskDict[i].status.progress_status="")}catch(o){}t.$notify({message:l["data"]["msg"],type:"success"})}else{try{l["data"]["msg"].indexOf("分享")>-1&&(t.taskDict[i].is_share=!1,t.taskDict[i].status.progress_status="")}catch(o){}t.$notify({message:l["data"]["msg"],type:"error"})}else t.taskDict[i].status.progress=l["progress"]}null!=t.taskList&&0!==t.taskList.length||(t.taskList=[],t.taskDict={},clearInterval(t.taskCheckInterval))}))}},removeArray:function(e,t){for(var a=0;a<e.length;a++)if(e[a]===t){e.splice(a,1);break}},loadLocalImages:function(){var e=this;this.localLoading=!0,f().then((function(t){var a=t.data,i=a.status,l=a.data;200===i&&(e.localImageList=l,e.tmpLocalImageList=l),e.localLoading=!1}))},handleClick:function(e,t){var a=e.name;"local"===a&&this.loadLocalImages()},handleLocalRemove:function(e){for(var t=0;t<this.localImageList.length;t++)if(this.localImageList[t].name===e){this.localImageList.splice(t,1);break}},handleSelectLocalImages:function(e){var t=[];for(var a in e)t.push(e[a].name);this.selectLocalImages=t},batchLocalAdd:function(){var e=this;if(0!==this.selectLocalImages.length){var t=new FormData;t.set("image_names",this.selectLocalImages.join(",")),p(t).then((function(t){var a=t.data,i=a.data,l=a.status;if(200===l){for(var n=0;n<i.length;n++){var s=i[n],r=s.replace(" ","").replace("拉取镜像","").replace("任务下发成功","");e.tmpImageNameList.push(r),e.$notify({title:"成功",message:s,type:"success"})}e.centerDialogVisible=!1,e.initTableData()}else 201===l?e.$notify({title:"失败",message:a["msg"],type:"info"}):e.$notify({title:"失败",message:a["msg"],type:"error"})}))}},delContainer:function(e){var t=this;Object(h["a"])(e.container_id).then((function(a){var i=a.data["data"],l=window.setInterval((function(){setTimeout((function(){Object(b["b"])(i).then((function(a){var i=a.data["status"],n=a.data;1001===i||(clearInterval(l),200===i?(t.$message({type:"success",message:"删除成功"}),m(e.image_id).then((function(e){var a=e.data;200!==a.status?t.deleteContainerList=a.data:(t.$message({type:"success",message:"删除成功"}),t.deleteShow=!1,t.initTableData())}))):t.$message({message:n["msg"],type:"error"}))}))}),1)}),1e3)}))}}},k=y,w=a("2877"),I=Object(w["a"])(k,i,l,!1,null,"7e1cb1e5",null);t["default"]=I.exports},ea7f:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return s}));var i=a("b775");function l(e){return Object(i["a"])({url:"/tasks/"+e+"/get/",method:"get"})}function n(e){return Object(i["a"])({url:"/tasks/batch/batch/",method:"post",data:e})}function s(e){return Object(i["a"])({url:"/tasks/"+e+"/progress/",method:"get"})}}}]);
//# sourceMappingURL=chunk-50de06a8.bec7092b.js.map